import{_ as K,r as i,a0 as d,a1 as v,a2 as s,a5 as e,a3 as a,a4 as c,a9 as T,a8 as q,ap as h,am as u,a6 as m,an as z,ao as W,aG as X,aH as Y,aI as R,J as Z,aF as L,aJ as ee,ac as ae,ad as oe,a7 as te}from"./index.d436ad73.js";import{a as se,Q as le}from"./QSelect.917dcf46.js";import{Q as D}from"./QInput.0f6ca6f6.js";import{Q as ie}from"./QPage.b58eb39f.js";import{C as re}from"./ClosePopup.66a9a7e9.js";import{_ as ne}from"./cotizaciones.31a1374b.js";import{u as ce}from"./use-quasar.6439df20.js";import{L as b}from"./LocalStorage.60d0e99e.js";import{S as P}from"./sweetalert2.esm.all.0f865825.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-key-composition.002912ea.js";import"./format.19399105.js";import"./use-file-dom-props.89b0fc0b.js";import"./selection.dbfae057.js";const n=I=>(ae("data-v-02436e68"),I=I(),oe(),I),de=n(()=>e("video",{autoplay:"",muted:"",loop:"",playsinline:"",class:"video-background"},[e("source",{src:ne,type:"video/mp4"}),te(" Tu navegador no soporta video HTML5. ")],-1)),me={class:"profile-header"},pe={class:"profile-info"},ve={class:"avatar-section"},fe=["src"],_e={class:"user-details"},he={class:"user-name"},be={class:"user-username"},ge={class:"user-role-badge"},Ce={class:"header-actions"},xe={class:"profile-content"},ke={class:"content-grid"},ye={class:"card-title"},we=n(()=>e("span",null,"Informaci\xF3n Personal",-1)),Ve={class:"info-item"},Ee=n(()=>e("span",{class:"info-label"},"Correo Electr\xF3nico",-1)),Ue={class:"info-value"},ze={class:"info-item"},De=n(()=>e("span",{class:"info-label"},"Rol en la Empresa",-1)),Pe={class:"info-value"},Ie={class:"info-item"},Se=n(()=>e("div",null,[e("span",{class:"info-label"},"Estado"),e("p",{class:"info-value"},"Activo")],-1)),Ae={class:"card-title"},Qe=n(()=>e("span",null,"Estad\xEDsticas",-1)),qe=n(()=>e("div",{class:"stat-item"},[e("div",{class:"stat-number"},"127"),e("div",{class:"stat-label"},"Clientes Atendidos")],-1)),Ne=n(()=>e("div",{class:"stat-item"},[e("div",{class:"stat-number"},"45"),e("div",{class:"stat-label"},"Viajes Vendidos")],-1)),Be=n(()=>e("div",{class:"stat-item"},[e("div",{class:"stat-number"},"98%"),e("div",{class:"stat-label"},"Satisfacci\xF3n")],-1)),Te={class:"card-title"},Re=n(()=>e("span",null,"Acciones R\xE1pidas",-1)),Le={class:"dialog-title"},Fe=n(()=>e("span",null,"Cambiar Foto de Perfil",-1)),Oe={class:"avatar-grid"},Ge=["src"],Je={class:"dialog-title"},$e=n(()=>e("span",null,"Editar Perfil",-1)),je={class:"form-grid"},He={__name:"PerfilUsuario",setup(I){ce(),K();const f=b.getItem("userData")||{},g=i(f.nombreCompleto||"Usuario"),C=i(f.usuario||"usuario_default"),x=i(f.email||"Multidestos@gmail.com"),r=i(f.rol||"Usuario"),S=i(f.imagenPerfil||"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80"),k=i(!1),A=i(!1),_=i(""),F=["administrador","Comercial 1","Comercial 2","Contable","Supervisor","Asesor"],O=["https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80","https://images.unsplash.com/photo-1494790108755-2616b612b23c?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80","https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80","https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80","https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80","https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=387&q=80"],G=l=>({administrador:"red-6","Comercial 1":"blue-6","Comercial 2":"green-6",Contable:"orange-6",Supervisor:"purple-6",Asesor:"teal-6"})[l]||"grey-6",N=async l=>{try{const o={...b.getItem("userData")||{},imagenPerfil:l};if((await fetch(`https://backmultidestinos.onrender.com/user/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)b.set("userData",o),S.value=l,A.value=!1,P.fire({title:"\xA1Perfecto!",text:"Tu foto de perfil ha sido actualizada",icon:"success",timer:2e3,showConfirmButton:!1,customClass:{container:"swal-high-z-index"},zIndex:1e4});else throw new Error("Error al actualizar avatar")}catch(t){console.error("Error updating avatar:",t),P.fire({title:"Error",text:"No se pudo actualizar la foto de perfil",icon:"error",confirmButtonColor:"#1976d2",customClass:{container:"swal-high-z-index"},zIndex:1e4})}},J=()=>{_.value&&(N(_.value),_.value="")},y=i(""),w=i(""),V=i(""),p=i(""),E=i(""),B=i(f.id||null),$=i({nombreCompleto:g.value,usuario:C.value,email:x.value,rol:r.value}),j=()=>{const l=b.getItem("userData")||{};y.value=l.nombreCompleto||g.value,w.value=l.usuario||C.value,V.value=l.email||x.value,E.value=l.rol||r.value,p.value="",B.value=l.id,$.value={nombreCompleto:l.nombreCompleto||g.value,usuario:l.usuario||C.value,email:l.email||x.value,rol:l.rol||r.value},k.value=!0},H=()=>{k.value=!1,y.value="",w.value="",V.value="",p.value="",E.value=""},M=async()=>{try{const t={...b.getItem("userData")||{},id:B.value,email:V.value};r.value==="administrador"&&(t.nombreCompleto=y.value,t.usuario=w.value,t.rol=E.value),p.value&&p.value.trim()!==""&&(t.contrasena=p.value),console.log("Datos a enviar:",t);const o=await fetch(`https://backmultidestinos.onrender.com/user/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(o.ok)b.set("userData",t),k.value=!1,await new Promise(U=>setTimeout(U,100)),g.value=t.nombreCompleto,C.value=t.usuario,x.value=t.email,r.value=t.rol,t.imagenPerfil&&(S.value=t.imagenPerfil),await P.fire({title:"\xA1\xC9xito!",text:"Tu perfil ha sido actualizado correctamente",icon:"success",timer:2e3,showConfirmButton:!1,customClass:{container:"swal-high-z-index"},zIndex:1e4});else{const U=await o.text();throw console.error("Error response:",U),new Error("Error al editar usuario: "+o.status)}}catch(l){console.error("Error updating profile:",l),P.fire({title:"Error",text:"No se pudo actualizar el perfil: "+l.message,icon:"error",confirmButtonColor:"#1976d2",customClass:{container:"swal-high-z-index"},zIndex:1e4})}},Q=()=>{P.fire({title:"Funcionalidad en desarrollo",text:"Esta caracter\xEDstica estar\xE1 disponible pr\xF3ximamente",icon:"info",confirmButtonText:"Entendido",confirmButtonColor:"#1976d2"})};return(l,t)=>(d(),v(ie,{class:"profile-page"},{default:s(()=>[de,e("div",me,[e("div",pe,[e("div",ve,[a(T,{size:"120px",class:"profile-avatar"},{default:s(()=>[e("img",{src:S.value,alt:"Foto de perfil"},null,8,fe),a(c,{round:"",size:"sm",color:"primary",icon:"photo_camera",class:"avatar-edit-btn",onClick:t[0]||(t[0]=o=>A.value=!0)})]),_:1})]),e("div",_e,[e("h2",he,q(g.value),1),e("p",be,"@"+q(C.value),1),e("div",ge,[a(se,{color:G(r.value),"text-color":"white",label:r.value,icon:"work"},null,8,["color","label"])])]),e("div",Ce,[a(c,{color:"primary",icon:"edit",label:"Editar Perfil",onClick:j,class:"edit-profile-btn"}),r.value==="administrador"?(d(),v(c,{key:0,color:"secondary",icon:"admin_panel_settings",label:"Panel Admin",to:"/ControlUser",class:"admin-btn"})):h("",!0)])])]),e("div",xe,[e("div",ke,[a(z,{class:"info-card"},{default:s(()=>[a(u,{class:"card-header"},{default:s(()=>[e("div",ye,[a(m,{name:"person",size:"24px"}),we])]),_:1}),a(u,{class:"info-content"},{default:s(()=>[e("div",Ve,[a(m,{name:"email",color:"primary"}),e("div",null,[Ee,e("p",Ue,q(x.value),1)])]),e("div",ze,[a(m,{name:"badge",color:"secondary"}),e("div",null,[De,e("p",Pe,q(r.value),1)])]),e("div",Ie,[a(m,{name:"verified_user",color:"positive"}),Se])]),_:1})]),_:1}),a(z,{class:"stats-card"},{default:s(()=>[a(u,{class:"card-header"},{default:s(()=>[e("div",Ae,[a(m,{name:"analytics",size:"24px"}),Qe])]),_:1}),a(u,{class:"stats-content"},{default:s(()=>[qe,Ne,Be]),_:1})]),_:1}),a(z,{class:"actions-card"},{default:s(()=>[a(u,{class:"card-header"},{default:s(()=>[e("div",Te,[a(m,{name:"quick_reference",size:"24px"}),Re])]),_:1}),a(u,{class:"actions-content"},{default:s(()=>[r.value==="administrador"?(d(),v(c,{key:0,flat:"",class:"quick-action-btn",icon:"settings",label:"Configuraci\xF3n del Sistema",onClick:Q})):h("",!0),a(c,{flat:"",class:"quick-action-btn",icon:"flight_takeoff",label:"Nuevo Destino",onClick:Q}),a(c,{flat:"",class:"quick-action-btn",icon:"people",label:"Gestionar Clientes",onClick:Q}),a(c,{flat:"",class:"quick-action-btn",icon:"report",label:"Generar Reporte",onClick:Q})]),_:1})]),_:1})])]),a(L,{modelValue:A.value,"onUpdate:modelValue":t[2]||(t[2]=o=>A.value=o),class:"avatar-dialog"},{default:s(()=>[a(z,{class:"avatar-card"},{default:s(()=>[a(u,{class:"dialog-header"},{default:s(()=>[e("div",Le,[a(m,{name:"photo_camera",size:"24px"}),Fe])]),_:1}),a(u,{class:"avatar-options"},{default:s(()=>[e("div",Oe,[(d(),W(Y,null,X(O,o=>a(T,{key:o,size:"80px",class:ee(["avatar-option",{selected:S.value===o}]),onClick:U=>N(o)},{default:s(()=>[e("img",{src:o},null,8,Ge)]),_:2},1032,["class","onClick"])),64))]),a(D,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=o=>_.value=o),label:"URL personalizada",outlined:"",dense:"",class:"custom-avatar-input","prepend-icon":"link"},null,8,["modelValue"])]),_:1}),a(R,{align:"right",class:"dialog-actions"},{default:s(()=>[Z(a(c,{flat:"",label:"Cancelar"},null,512),[[re]]),_.value?(d(),v(c,{key:0,color:"primary",label:"Aplicar URL",onClick:J})):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(L,{modelValue:k.value,"onUpdate:modelValue":t[8]||(t[8]=o=>k.value=o),class:"edit-dialog",persistent:""},{default:s(()=>[a(z,{class:"edit-card"},{default:s(()=>[a(u,{class:"dialog-header"},{default:s(()=>[e("div",Je,[a(m,{name:"edit",size:"24px"}),$e])]),_:1}),a(u,{class:"edit-form"},{default:s(()=>[e("div",je,[r.value==="administrador"?(d(),v(D,{key:0,modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=o=>y.value=o),label:"Nombre completo",outlined:"",dense:"","prepend-icon":"person",rules:[o=>!!o||"Campo obligatorio"]},null,8,["modelValue","rules"])):h("",!0),a(D,{modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=o=>V.value=o),label:"Correo Electr\xF3nico",outlined:"",dense:"","prepend-icon":"email",type:"email",rules:[o=>!!o||"Campo obligatorio"]},null,8,["modelValue","rules"]),r.value==="administrador"?(d(),v(D,{key:1,modelValue:w.value,"onUpdate:modelValue":t[5]||(t[5]=o=>w.value=o),label:"Nombre de Usuario",outlined:"",dense:"","prepend-icon":"alternate_email",rules:[o=>!!o||"Campo obligatorio"]},null,8,["modelValue","rules"])):h("",!0),r.value==="administrador"?(d(),v(le,{key:2,modelValue:E.value,"onUpdate:modelValue":t[6]||(t[6]=o=>E.value=o),label:"Rol",outlined:"",dense:"","prepend-icon":"work",options:F,rules:[o=>!!o||"El rol es obligatorio"]},null,8,["modelValue","rules"])):h("",!0),a(D,{modelValue:p.value,"onUpdate:modelValue":t[7]||(t[7]=o=>p.value=o),label:"Nueva Contrase\xF1a",outlined:"",dense:"","prepend-icon":"lock",type:"password",rules:[o=>!!o||"Campo obligatorio"]},null,8,["modelValue","rules"])])]),_:1}),a(R,{align:"right",class:"dialog-actions"},{default:s(()=>[a(c,{flat:"",label:"Cancelar",onClick:H}),a(c,{color:"primary",label:"Guardar Cambios",onClick:M})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};var na=ue(He,[["__scopeId","data-v-02436e68"]]);export{na as default};

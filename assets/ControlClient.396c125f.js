import{af as c,M as E,N as x,O as n,P as i,W as p,Y as t,ag as w,R as y,S as j}from"./index.ae6a05b7.js";import{Q as F,c as a}from"./QCard.5a4c112a.js";import{d as A,e as B,f as d,Q as T,i as Z,j as N}from"./QPage.c15636dd.js";import{Q as k}from"./QForm.f425c75f.js";import{_ as O}from"./plugin-vue_export-helper.3aa83b6a.js";import"./QItemLabel.d17ccbd9.js";const P={data(){return{rteFuente:"",porcentajeIva:"",rteIca:"",tipoBase:"",zonasOptions:[],zonaEditar:"",asesoresOptions:[],asesorEditar:"",zona:"",asesorCargo:"",zonas:[],usuariosPorZona:{"Zona 1":[],"Zona 2":[]},nombre:"",ciudad:"",correo:"",direccion:"",telefono:"",nit:"",rnt:"",lmc:"",demas:"",primerDeposito:"",segundoDeposito:"",nombreEditar:"",ciudadEditar:"",correoEditar:"",direccionEditar:"",telefonoEditar:"",nitEditar:"",rntEditar:"",lmcEditar:"",demasEditar:"",primerDepositoEditar:"",segundoDepositoEditar:"",rteFuenteEditar:"",porcentajeIvaEditar:"",rteIcaEditar:"",tipoBaseEditar:"",clienteEditandoId:null,clientes:[],columnas:[{name:"nombre",label:"Nombre",align:"left",field:"nombre"},{name:"ciudad",label:"Ciudad",align:"left",field:"ciudad"},{name:"correo",label:"Correo",align:"left",field:"correo"},{name:"direccion",label:"Direcci\xF3n",align:"left",field:"direccion"},{name:"telefono",label:"Tel\xE9fono",align:"left",field:"telefono"},{name:"nit",label:"NIT",align:"left",field:"nit"},{name:"rnt",label:"RNT",align:"left",field:"rnt"},{name:"lmc",label:"LMC",align:"left",field:"lmc"},{name:"demas",label:"Dem\xE1s",align:"left",field:"demas"},{name:"primerDeposito",label:"Primer Dep\xF3sito",align:"left",field:"primerDeposito"},{name:"segundoDeposito",label:"Segundo Dep\xF3sito",align:"left",field:"segundoDeposito"}],mostrarModalAgregar:!1,mostrarModalEditar:!1}},computed:{formValido(){return this.nombre&&this.ciudad&&this.correo&&this.direccion&&this.telefono&&this.nit&&this.rnt&&this.lmc&&this.demas&&this.primerDeposito&&this.segundoDeposito},formValidoEditar(){return this.nombreEditar&&this.ciudadEditar&&this.correoEditar&&this.direccionEditar&&this.telefonoEditar&&this.nitEditar&&this.rntEditar&&this.lmcEditar&&this.demasEditar&&this.primerDepositoEditar&&this.segundoDepositoEditar}},mounted(){this.cargarZonasYUsuarios(),this.cargarClientes()},methods:{async cargarAsesoresPorZona(){try{if(console.log("Cargando asesores por zona..."),!this.zonaEditar){console.log("No se ha seleccionado ninguna zona."),this.asesoresOptions=[];return}console.log("Zona seleccionada:",this.zonaEditar);const l=await fetch("https://backendmultidestinosexpress.onrender.com/user/zona/zona");if(!l.ok)throw new Error("Error al cargar los asesores por zona");const m=(await l.json()).filter(o=>o.zona===this.zonaEditar).map(o=>({value:o.id,label:o.nombreCompleto}));this.asesoresOptions=m,console.log("Asesores por zona cargados exitosamente:",this.asesoresOptions),this.asesorEditar=""}catch(l){console.error("Error al cargar asesores por zona:",l)}},async cargarZonasYUsuarios(){try{console.log("Cargando zonas y usuarios...");const l=await fetch("https://backendmultidestinosexpress.onrender.com/user/zona/zona");if(!l.ok)throw new Error("Error al cargar las zonas y usuarios");const e=await l.json(),r={"Zona 1":[],"Zona 2":[]};e.forEach(m=>{const o=m.zona;r[o]&&r[o].push({value:m.id,label:m.nombreCompleto})}),this.zonas=Object.keys(r),this.usuariosPorZona=r,console.log("Zonas y usuarios cargados exitosamente:",this.zonas,this.usuariosPorZona)}catch(l){console.error("Error al cargar zonas y usuarios:",l)}},cargarClientes(){fetch("https://backendmultidestinosexpress.onrender.com/cliente").then(l=>l.json()).then(l=>{const e=l.map(r=>{var m,o,u,s,h,b,g,V,f,v,_,C,q,D,I,z,U;return{id:r.id,nombre:(m=r.nombre)!=null?m:"",ciudad:(o=r.ciudad)!=null?o:"",correo:(u=r.correo)!=null?u:"",direccion:(s=r.direccion)!=null?s:"",telefono:(h=r.telefono)!=null?h:"",nit:(b=r.nit)!=null?b:"",rnt:(g=r.rnt)!=null?g:"",lmc:(V=r.lmc)!=null?V:"",demas:(f=r.demas)!=null?f:"",primerDeposito:(v=r.primerDeposito)!=null?v:"",segundoDeposito:(_=r.segundoDeposito)!=null?_:"",zona:(C=r.zona)!=null?C:"",asesor:(q=r.asesor)!=null?q:"",rteFuente:(D=r.rteFuente)!=null?D:"",porcentajeIva:(I=r.porcentajeIva)!=null?I:"",rteIca:(z=r.rteIca)!=null?z:"",tipoBase:(U=r.tipoBase)!=null?U:""}});console.log(e),this.clientes=e}).catch(l=>{console.error("Error al obtener los datos:",l)})},submitForm(){const l=this.zona?this.usuariosPorZona[this.zona][0].value:null,e={nombre:this.nombre,ciudad:this.ciudad?this.ciudad:null,correo:this.correo?this.correo:null,direccion:this.direccion?this.direccion:null,telefono:this.telefono?this.telefono:null,nit:this.nit?this.nit:null,rnt:this.rnt?this.rnt:null,lmc:this.lmc,demas:this.demas,primerDeposito:this.primerDeposito?this.primerDeposito:null,segundoDeposito:this.segundoDeposito?this.segundoDeposito:null,zona:this.zona?this.zona:null,asesor:l,tipoBase:this.tipoBase,porcentajeIva:this.porcentajeIva?this.porcentajeIva:null,rteFuente:this.rteFuente?this.rteFuente:null,rteIca:this.rteIca?this.rteIca:null};console.log("newClient",e),fetch("https://backendmultidestinosexpress.onrender.com/cliente/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(r=>r.json()).then(r=>{c.create({message:"Cliente agregado correctamente",color:"positive"}),this.cargarClientes(),this.limpiarFormulario(),this.mostrarModalAgregar=!1}).catch(r=>{console.error("Error al agregar cliente:",r),c.create({message:"Error al agregar cliente",color:"negative"})})},editarCliente(l){const e=`https://backendmultidestinosexpress.onrender.com/user/${l.asesor}`;fetch(e).then(r=>r.json()).then(r=>{l.nombreCompleto=r.nombreCompleto,l.usuario=r.usuario,l.contrasena=r.contrasena,l.activo=r.activo,l.rol=r.rol,l.zona=r.zona,this.zonaEditar=l.zona,this.asesorEditar=l.nombreCompleto,this.nombreEditar=l.nombre,this.ciudadEditar=l.ciudad,this.correoEditar=l.correo,this.direccionEditar=l.direccion,this.telefonoEditar=l.telefono,this.nitEditar=l.nit,this.rntEditar=l.rnt,this.lmcEditar=l.lmc,this.demasEditar=l.demas,this.primerDepositoEditar=l.primerDeposito,this.segundoDepositoEditar=l.segundoDeposito,this.rteFuenteEditar=l.rteFuente,this.porcentajeIvaEditar=l.porcentajeIva,this.rteIcaEditar=l.rteIca,this.tipoBaseEditar=l.tipoBase,this.clienteEditandoId=l.id,this.mostrarModalEditar=!0}).catch(r=>{console.error("Error al obtener la informaci\xF3n del cliente:",r)})},editarClienteSubmit(){const l=this.zonaEditar?this.usuariosPorZona[this.zonaEditar][0].value:null,e={id:this.clienteEditandoId,nombre:this.nombreEditar,ciudad:this.ciudadEditar?this.ciudadEditar:null,correo:this.correoEditar?this.correoEditar:null,direccion:this.direccionEditar?this.direccionEditar:null,telefono:this.telefonoEditar?this.telefonoEditar:null,nit:this.nitEditar?this.nitEditar:null,rnt:this.rntEditar?this.rntEditar:null,lmc:this.lmcEditar,demas:this.demasEditar,primerDeposito:this.primerDepositoEditar,segundoDeposito:this.segundoDepositoEditar,zona:this.zonaEditar?this.zonaEditar:null,rteFuente:this.rteFuenteEditar?this.rteFuenteEditar:null,porcentajeIva:this.porcentajeIvaEditar?this.porcentajeIvaEditar:null,rteIca:this.rteIcaEditar?this.rteIcaEditar:null,tipoBase:this.tipoBaseEditar?this.tipoBaseEditar:null,asesor:l};fetch(`https://backendmultidestinosexpress.onrender.com/cliente/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(r=>{r.ok?(c.create({message:"Cliente editado correctamente",color:"positive"}),this.cargarClientes(),this.limpiarFormularioEditar(),this.mostrarModalEditar=!1):(console.error("Error al editar cliente:",r.statusText),c.create({message:"Error al editar cliente",color:"negative"}))}).catch(r=>{console.error("Error al editar cliente:",r),c.create({message:"Error al editar cliente",color:"negative"})})},eliminarCliente(l){fetch(`https://backendmultidestinosexpress.onrender.com/cliente/${l}`,{method:"DELETE"}).then(e=>{e.ok?(c.create({message:"Cliente eliminado correctamente",color:"positive"}),this.clientes=this.clientes.filter(r=>r.id!==l)):(console.error("Error al eliminar cliente:",e.statusText),c.create({message:"Error al eliminar cliente",color:"negative"}))}).catch(e=>{console.error("Error al eliminar cliente:",e),c.create({message:"Error al eliminar cliente",color:"negative"})})},limpiarFormulario(){this.nombre="",this.ciudad="",this.correo="",this.direccion="",this.telefono="",this.nit="",this.rnt="",this.lmc="",this.demas="",this.primerDeposito="",this.segundoDeposito="",this.rteFuente="",this.porcentajeIva="",this.rteIca="",this.tipoBase=""},limpiarFormularioEditar(){this.nombreEditar="",this.ciudadEditar="",this.correoEditar="",this.direccionEditar="",this.telefonoEditar="",this.nitEditar="",this.rntEditar="",this.lmcEditar="",this.demasEditar="",this.primerDepositoEditar="",this.segundoDepositoEditar="",this.rteFuenteEditar="",this.porcentajeIvaEditar="",this.rteIcaEditar="",this.tipoBaseEditar="",this.clienteEditandoId=null}}},M={class:"q-ma-md"},Q={class:"q-gutter-md"},S={class:"row q-col-gutter-md"},R={class:"col"},L={class:"col"},G={class:"row q-col-gutter-md"},Y={class:"col"},J={class:"col"},W={class:"row q-col-gutter-md"},H={class:"col"},K={class:"col"},X={class:"row q-col-gutter-md"},$={class:"col"},ee={class:"col"},oe={class:"row q-col-gutter-md"},se={class:"col"},te={class:"col"},le={class:"row q-col-gutter-md"},ie={class:"col"},re={class:"col"},ae={key:0,class:"row q-col-gutter-md"},ne={class:"col"},de={class:"col"},me={class:"col"},ue={class:"row q-col-gutter-md"},ce={class:"col"},pe={class:"col"},he={class:"row justify-end q-mt-md"},Ee={class:"q-ma-md"},be={class:"q-gutter-md"},ge={class:"row q-col-gutter-md"},Ve={class:"col"},fe={class:"col"},ve={class:"row q-col-gutter-md"},_e={class:"col"},Ce={class:"col"},qe={class:"row q-col-gutter-md"},De={class:"col"},Ie={class:"col"},ze={class:"row q-col-gutter-md"},Ue={class:"col"},we={class:"col"},ye={class:"row q-col-gutter-md"},je={class:"col"},Fe={class:"col"},Be={class:"row q-col-gutter-md"},Te={class:"col"},ke={class:"col"},xe={key:0,class:"row q-col-gutter-md"},Ae={class:"col"},Ze={class:"col"},Ne={class:"col"},Oe={class:"row q-col-gutter-md"},Pe={class:"col"},Me={class:"col"},Qe={class:"row justify-end q-mt-md"};function Se(l,e,r,m,o,u){return E(),x(A,{class:"q-pa-md"},{default:n(()=>[i(p,{onClick:e[0]||(e[0]=s=>o.mostrarModalAgregar=!0),label:"Agregar Cliente",class:"q-mb-md",color:"primary"}),i(T,{modelValue:o.mostrarModalAgregar,"onUpdate:modelValue":e[18]||(e[18]=s=>o.mostrarModalAgregar=s),"content-css":"max-width: 800px;"},{default:n(()=>[i(F,null,{default:n(()=>[i(B,{class:"q-pa-md"},{default:n(()=>[t("div",M,[i(k,{onSubmit:u.submitForm},{default:n(()=>[t("div",Q,[t("div",S,[t("div",R,[i(a,{label:"Nombre",modelValue:o.nombre,"onUpdate:modelValue":e[1]||(e[1]=s=>o.nombre=s),rules:[s=>!!s||"El nombre es obligatorio"],class:"q-mb-md"},null,8,["modelValue","rules"])]),t("div",L,[i(d,{modelValue:o.ciudad,"onUpdate:modelValue":e[2]||(e[2]=s=>o.ciudad=s),label:"Ciudad",class:"q-mb-md",options:["BOGOTA","CALI"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue"])])]),t("div",G,[t("div",Y,[i(a,{label:"Correo",modelValue:o.correo,"onUpdate:modelValue":e[3]||(e[3]=s=>o.correo=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",J,[i(a,{label:"Direcci\xF3n",modelValue:o.direccion,"onUpdate:modelValue":e[4]||(e[4]=s=>o.direccion=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",W,[t("div",H,[i(a,{label:"Tel\xE9fono",modelValue:o.telefono,"onUpdate:modelValue":e[5]||(e[5]=s=>o.telefono=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",K,[i(a,{label:"NIT",modelValue:o.nit,"onUpdate:modelValue":e[6]||(e[6]=s=>o.nit=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",X,[t("div",$,[i(a,{label:"RNT",modelValue:o.rnt,"onUpdate:modelValue":e[7]||(e[7]=s=>o.rnt=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",ee,[i(a,{label:"LMC",modelValue:o.lmc,"onUpdate:modelValue":e[8]||(e[8]=s=>o.lmc=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",oe,[t("div",se,[i(a,{label:"Dem\xE1s",modelValue:o.demas,"onUpdate:modelValue":e[9]||(e[9]=s=>o.demas=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",te,[i(a,{label:"1er Dep\xF3sito",modelValue:o.primerDeposito,"onUpdate:modelValue":e[10]||(e[10]=s=>o.primerDeposito=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",le,[t("div",ie,[i(a,{label:"2do Dep\xF3sito",modelValue:o.segundoDeposito,"onUpdate:modelValue":e[11]||(e[11]=s=>o.segundoDeposito=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",re,[i(d,{modelValue:o.tipoBase,"onUpdate:modelValue":e[12]||(e[12]=s=>o.tipoBase=s),label:"Tipo de Base",options:["Comisi\xF3n","Descuento"],class:"q-mb-md"},null,8,["modelValue"])])]),o.tipoBase==="Comisi\xF3n"?(E(),w("div",ae,[t("div",ne,[i(a,{type:"number",label:"Porcentaje de IVA",modelValue:o.porcentajeIva,"onUpdate:modelValue":e[13]||(e[13]=s=>o.porcentajeIva=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",de,[i(d,{modelValue:o.rteFuente,"onUpdate:modelValue":e[14]||(e[14]=s=>o.rteFuente=s),label:"RTE Fuente",options:["10","11"],class:"q-mb-md"},null,8,["modelValue"])]),t("div",me,[i(d,{modelValue:o.rteIca,"onUpdate:modelValue":e[15]||(e[15]=s=>o.rteIca=s),label:"RTE ICA",options:["0.966","1.4"],class:"q-mb-md"},null,8,["modelValue"])])])):y("",!0),t("div",ue,[t("div",ce,[i(d,{modelValue:o.zona,"onUpdate:modelValue":e[16]||(e[16]=s=>o.zona=s),label:"Zona",options:o.zonas,class:"q-mb-md"},null,8,["modelValue","options"])]),t("div",pe,[i(d,{modelValue:o.asesorCargo,"onUpdate:modelValue":e[17]||(e[17]=s=>o.asesorCargo=s),label:"Asesor Cargo",options:o.usuariosPorZona[o.zona],class:"q-mb-md"},null,8,["modelValue","options"])])])]),t("div",he,[i(p,{type:"submit",label:"Registrar",color:"primary"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(T,{modelValue:o.mostrarModalEditar,"onUpdate:modelValue":e[36]||(e[36]=s=>o.mostrarModalEditar=s),"content-css":"max-width: 800px;"},{default:n(()=>[i(F,null,{default:n(()=>[i(B,{class:"q-pa-md"},{default:n(()=>[t("div",Ee,[i(k,{onSubmit:u.editarClienteSubmit},{default:n(()=>[t("div",be,[t("div",ge,[t("div",Ve,[i(a,{label:"Nombre",modelValue:o.nombreEditar,"onUpdate:modelValue":e[19]||(e[19]=s=>o.nombreEditar=s),rules:[s=>!!s||"El nombre es obligatorio"],class:"q-mb-md"},null,8,["modelValue","rules"])]),t("div",fe,[i(d,{modelValue:o.ciudadEditar,"onUpdate:modelValue":e[20]||(e[20]=s=>o.ciudadEditar=s),label:"Ciudad",class:"q-mb-md",options:["BOGOTA","CALI"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue"])])]),t("div",ve,[t("div",_e,[i(a,{label:"Correo",modelValue:o.correoEditar,"onUpdate:modelValue":e[21]||(e[21]=s=>o.correoEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",Ce,[i(a,{label:"Direcci\xF3n",modelValue:o.direccionEditar,"onUpdate:modelValue":e[22]||(e[22]=s=>o.direccionEditar=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",qe,[t("div",De,[i(a,{label:"Tel\xE9fono",modelValue:o.telefonoEditar,"onUpdate:modelValue":e[23]||(e[23]=s=>o.telefonoEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",Ie,[i(a,{label:"NIT",modelValue:o.nitEditar,"onUpdate:modelValue":e[24]||(e[24]=s=>o.nitEditar=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",ze,[t("div",Ue,[i(a,{label:"RNT",modelValue:o.rntEditar,"onUpdate:modelValue":e[25]||(e[25]=s=>o.rntEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",we,[i(a,{label:"LMC",modelValue:o.lmcEditar,"onUpdate:modelValue":e[26]||(e[26]=s=>o.lmcEditar=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",ye,[t("div",je,[i(a,{label:"Dem\xE1s",modelValue:o.demasEditar,"onUpdate:modelValue":e[27]||(e[27]=s=>o.demasEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",Fe,[i(a,{label:"1er Dep\xF3sito",modelValue:o.primerDepositoEditar,"onUpdate:modelValue":e[28]||(e[28]=s=>o.primerDepositoEditar=s),class:"q-mb-md"},null,8,["modelValue"])])]),t("div",Be,[t("div",Te,[i(a,{label:"2do Dep\xF3sito",modelValue:o.segundoDepositoEditar,"onUpdate:modelValue":e[29]||(e[29]=s=>o.segundoDepositoEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",ke,[i(d,{modelValue:o.tipoBaseEditar,"onUpdate:modelValue":e[30]||(e[30]=s=>o.tipoBaseEditar=s),label:"Tipo de Base",options:["Comisi\xF3n","Descuento"],class:"q-mb-md"},null,8,["modelValue"])])]),o.tipoBaseEditar==="Comisi\xF3n"?(E(),w("div",xe,[t("div",Ae,[i(a,{type:"number",label:"Porcentaje de IVA",modelValue:o.porcentajeIvaEditar,"onUpdate:modelValue":e[31]||(e[31]=s=>o.porcentajeIvaEditar=s),class:"q-mb-md"},null,8,["modelValue"])]),t("div",Ze,[i(d,{modelValue:o.rteFuenteEditar,"onUpdate:modelValue":e[32]||(e[32]=s=>o.rteFuenteEditar=s),label:"RTE Fuente",options:[10,11],class:"q-mb-md"},null,8,["modelValue"])]),t("div",Ne,[i(d,{modelValue:o.rteIcaEditar,"onUpdate:modelValue":e[33]||(e[33]=s=>o.rteIcaEditar=s),label:"RTE ICA",options:["0.966","1.4"],class:"q-mb-md"},null,8,["modelValue"])])])):y("",!0),t("div",Oe,[t("div",Pe,[i(d,{modelValue:o.zonaEditar,"onUpdate:modelValue":[e[34]||(e[34]=s=>o.zonaEditar=s),u.cargarAsesoresPorZona],label:"Zona",options:["Zona 1","Zona 2"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue","onUpdate:modelValue"])]),t("div",Me,[i(d,{modelValue:o.asesorEditar,"onUpdate:modelValue":e[35]||(e[35]=s=>o.asesorEditar=s),label:"Asesor",options:o.asesoresOptions,"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue","options"])])])]),t("div",Qe,[i(p,{type:"submit",label:"Guardar Cambios",color:"primary"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(N,{rows:o.clientes,columns:[...o.columnas,{name:"acciones",label:"Acciones",align:"center"}],"row-key":"id",pagination:!0,class:"q-mt-md"},{"body-cell-acciones":n(s=>[i(Z,{props:s,class:"fit"},{default:n(()=>[i(p,{dense:"",color:"primary",onClick:h=>u.editarCliente(s.row),style:{"margin-right":"3px"}},{default:n(()=>[j("Editar")]),_:2},1032,["onClick"]),i(p,{dense:"",color:"negative",onClick:h=>u.eliminarCliente(s.row.id),style:{"margin-left":"3px"}},{default:n(()=>[j("Eliminar")]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})}var He=O(P,[["render",Se],["__scopeId","data-v-6eb15b56"]]);export{He as default};

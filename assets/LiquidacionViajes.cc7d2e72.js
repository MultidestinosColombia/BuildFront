import{ad as It,ax as Dt,a0 as Lt,a1 as Ot,a2 as T,as as Pt,aj as pe,a5 as E,at as je,av as Et,az as zt,aC as Rt,aB as gt,a9 as Nt,aa as xt,aG as Ft,af as pt,au as Ct,be as vt,N as wt,aA as Vt,bc as Mt}from"./index.78b815cd.js";import{E as Tt,n as ie}from"./PDFButton.2605e19d.js";import{a as x}from"./axios.37d53be1.js";const Ht={data(){return{mostrarDialogo:!1,facturaOtroNombre:!1,nombreFactura:"",liquidacionSeleccionada:null,filterId:"",filterStatus:null,statusOptions:[{label:"Aprobado",value:"Aprobado"},{label:"Rechazado",value:"Rechazado"},{label:"Pendiente",value:"Pendiente"}],filter:"",rows:[],columns:[{name:"status",label:"Status",field:"status"},{name:"idLiquidacion",label:"ID Liquidaci\xF3n",field:"idLiquidacion",sortable:!0},{name:"idCotizacion",label:"ID Cotizaci\xF3n",field:"idCotizacion",sortable:!0},{name:"salida",label:"Salida",field:"salida"},{name:"destino",label:"Destino",field:"destino"},{name:"nombrePrograma",label:"Nombre del Programa",field:"nombrePrograma"},{name:"hotel",label:"Hotel",field:"hotel"},{name:"totalPasajeros",label:"Total Pasajeros",field:"totalPasajeros"},{name:"precioBrutoTotal",label:"Precio Bruto Total",field:"precioBrutoTotal"},{name:"totalPrecioCliente",label:"Total Precio Cliente",field:"totalPrecioCliente"},{name:"fechaCreacion",label:"Fecha de Creaci\xF3n",field:m=>new Date(m.fechaCreacion).toLocaleDateString(),sortable:!0},{name:"acciones",label:"Acciones"}]}},computed:{filteredRows(){const m=this.filterId.toLowerCase();return this.rows.filter(N=>{const L=N.idCotizacion.toLowerCase().includes(m),ee=this.filterStatus===null||N.status===this.filterStatus;return L&&ee})}},methods:{mostrarDialogoFactura(m){this.liquidacionSeleccionada=m,this.mostrarDialogo=!0},async procesarDescarga(){this.mostrarDialogo=!1;try{await x.put(`https://backmultidestinos.onrender.com/liquidacion/${this.liquidacionSeleccionada.idLiquidacion}`,{facturaPara:this.nombreFactura?this.nombreFactura:null})}catch(m){console.error("Error al actualizar la liquidaci\xF3n:",m),Dt.create({message:"Error al actualizar la liquidaci\xF3n.",color:"negative"});return}this.liquidacionSeleccionada.idCotizacion.includes("-C")?this.descargarLiquidacionCano(this.liquidacionSeleccionada.idCotizacion,this.liquidacionSeleccionada.idLiquidacion):this.descargarLiquidacion(this.liquidacionSeleccionada.idCotizacion,this.liquidacionSeleccionada.idLiquidacion),this.nombreFactura=""},chipColor(m){switch(m){case"Aprobado":return"green";case"Rechazado":return"red";case"Pendiente":return"orange";default:return"grey"}},verDetalles(m){this.$router.push({name:"LiquidacionDetalles",params:{idLiquidacion:m.idLiquidacion,liquidacionData:m}})},descargarLiquidacionN(m){m.idCotizacion.includes("-C")?this.descargarLiquidacionCano(m.idCotizacion,m.idLiquidacion):this.descargarLiquidacion(m.idCotizacion,m.idLiquidacion)},async descargarLiquidacion(m,N){try{let L=function(l,o,n,s=10){return o+n>Se-s?(l.addPage(),a.top):o},ct=function(l){return l.map(o=>{const n=o.adultos,s=o.ni\u00F1os,f=`1x${n}`;return s>0?`${f} CHD`:f}).join(", ")},_=function(l){for(let o=0;o<=6;o++){const n=a.left+o*g;e.line(n,l,n,l+u)}e.line(a.left,l,p-a.right,l),e.line(a.left,l+u,p-a.right,l+u)};const[ee,b,te,A,ye]=await Promise.all([x.get(`https://backmultidestinos.onrender.com/habitacionCotizacion/${m}`),x.get(`https://backmultidestinos.onrender.com/cotizacion/${m}`),x.get(`https://backmultidestinos.onrender.com/ImpuestoCot/${m}`),x.get(`https://backmultidestinos.onrender.com/liquidacion/${N}`),x.get(`https://backmultidestinos.onrender.com/pasajero/${N}`)]);if(ee.status!==200||b.status!==200){console.error("Error al obtener datos de habitacionCotizacion o cotizacion");return}const t=b.data[0],O=te.data[0];console.log("impuesto",O);const k=ee.data;console.log("habitacion",k);const j=A.data;console.log("liquidacion",j);const We=j[0].telefono;console.log(We);const Oe=ye.data;console.log("pasajero",Oe);const P=await x.get(`https://backmultidestinos.onrender.com/cliente/buscar/${t.cliente}`);console.log("clienteResponse",P);const R=P.data[0];console.log("clienteData",R);const ne=R.tipoBase,Pe=await x.get(`https://backmultidestinos.onrender.com/user/${t.CreadorCotizacion}`),St=Pe.Data;console.log("vendedor",Pe.data.nombreCompleto);const Ue={hotel:t.hotel,nombrePrograma:t.nombrePrograma,destino:t.destino},_e=await x.post("https://backmultidestinos.onrender.com/hoteles/buscar",Ue),nt=t.incluye?t.incluye:_e.data[0].incluye,i=t.noIncluye?t.noIncluye:_e.data[0].noIncluye,e=new Tt,a={top:10,bottom:10,left:10,right:10},p=e.internal.pageSize.width,Se=e.internal.pageSize.height,F=40,v={left:10,right:10,top:5,bottom:5},ze=await new Promise((l,o)=>{const n=new Image;n.src="https://i.ibb.co/1sFJ7dT/imgAzul.png",n.onload=()=>l(n),n.onerror=o}),lt=ze.width/ze.height,Ae=p/4-v.left-v.right,le=Math.min(100,Ae),$e=le/lt,st=a.top+(F-$e)/2,Ye=`PBX(601)7621133
CALLE 64 No. 11-37 LOC 301
EMAIL: MULTIDESTINOS_EXPRESS@YAHOO.COM`,ke=`Numero de cotizaci\xF3n: ${m}`;e.addImage(ze,"PNG",a.left+v.left,st,le,$e);const rt=p-a.left-a.right-le-v.left-v.right-10;e.setFontSize(10),e.text(e.splitTextToSize(Ye,rt),a.left+le+v.left+v.right,a.top+10);const Qe=p-a.right-e.getTextWidth(ke)-v.right;e.setFontSize(12),e.setFont("Helvetica-Bold",12),e.text(ke,Qe,a.top+10),e.setDrawColor(0),e.rect(a.left,a.top,p-a.left-a.right,F,"S"),e.setFontSize(10);const Ee=a.top+F+10;e.setFontSize(10),e.text("SOLICITUD DE RESERVA:",a.left,Ee-4),e.setFontSize(8);const Ne=["FECHA SOLICITUD:","AGENCIA:","TEL\xC9FONO:","CONTACTO:","NIT:","VENDEDOR:"],Re=[new Date(new Date(t.fechaCreacion).getTime()+new Date(t.fechaCreacion).getTimezoneOffset()*6e4).toLocaleDateString(),t.cliente.toString(),R.telefono?R.telefono.toString():"N/A","N/A",R.nit?R.nit.toString():"N/A",Pe.data.nombreCompleto?Pe.data.nombreCompleto.toString():"N/A"],Fe=6,y=(p-a.left-a.right)/Fe;let r=a.left,d=Ee;for(let l=0;l<Ne.length;l++){e.text(Ne[l],r,d);const o=Re[l]!==void 0?Re[l]:"N/A",n=e.splitTextToSize(o,y-2);e.text(n,r,d+5),r+=y,((l+1)%Fe===0||l===Ne.length-1)&&(d+=15,r=a.left)}const Ge=ct(k),xe=["NOCHES:","HOTEL:","PLAN:","DESTINO:","DIRECCION:","ACOMODACI\xD3N:"],ve=[t.noches?t.noches.toString():"N/A",t.hotel?t.hotel.toString():"N/A",t.plan?t.plan.toString():"N/A",t.destino?t.destino.toString():"N/A",t.direccion?t.direccion.toString():"N/A",Ge.toString()];console.log("campso2",ve);const Je=6,we=(p-a.left-a.right)/Je;d+=1;for(let l=0;l<xe.length;l++){e.text(xe[l],r,d);const o=ve[l]!==void 0?ve[l]:"N/A",n=e.splitTextToSize(o,we-2);e.text(n,r,d+5),r+=we}d+=1,e.setFontSize(10),e.text("PASAJEROS: ",a.left,d+12),d+=20;const Ve=["NOMBRE","DOCUMENTO","F. NACIMIENTO","EDAD","TELEFONO RESERVA"],Me=Oe.map(l=>{const o=new Date(l.fechaNacimiento),n=new Date;let s=n.getFullYear()-o.getFullYear();const f=n.getMonth()-o.getMonth();return(f<0||f===0&&n.getDate()<o.getDate())&&s--,[l.nombre,l.numeroDocumento,o.toLocaleDateString(),s,j[0].telefono?j[0].telefono.toString():"N/A"]}),Xe=(p-a.left-a.right)/Ve.length,Ze=p-a.left-a.right,He=10+8*Me.length;e.rect(a.left,d,Ze,He,"S"),e.setFontSize(8),Ve.forEach((l,o)=>{e.text(l,a.left+5+o*Xe,d+5)}),d+=10,Me.forEach((l,o)=>{l.forEach((n,s)=>{e.text(n.toString(),a.left+5+s*Xe,d+o*8)})}),d+=He-15,d+=22,e.setFontSize(10),e.text("ITINERARIO: ",a.left,d-10);const oe=["AEROLINEA","VUELO","FECHA","RUTA","CLASE","HR SALIDA","HR LLEGADA","RECORD"],ae=[[t.aerolineaIda||"N/A",t.vueloIda||"N/A",t.fechaInicio?new Date(new Date(t.fechaInicio).getTime()+new Date(t.fechaInicio).getTimezoneOffset()*6e4).toLocaleDateString():"N/A",t.ruta1||"N/A",t.claseIda||"N/A",t.horaSalidaIda||"N/A",t.horaLlegadaIda||"N/A",t.recordIda||"N/A"]];t.aerolineaEscalaIda!=null&&(ae.push([t.aerolineaEscalaIda||"N/A",t.vueloEscalaIda||"N/A",t.fechaInicio?new Date(new Date(t.fechaInicio).getTime()+new Date(t.fechaInicio).getTimezoneOffset()*6e4).toLocaleDateString():"N/A","Escala Ida",t.claseEscalaIda||"N/A",t.horaSalidaEscalaIda||"N/A",t.horaLlegadaEscalaIda||"N/A",""]),ae.push([t.aerolineaEscalaVuelta||"N/A",t.vueloEscalaVuelta||"N/A",t.fechaFin?new Date(new Date(t.fechaFin).getTime()+new Date(t.fechaFin).getTimezoneOffset()*6e4).toLocaleDateString():"N/A","Escala Vuelta",t.claseEscalaVuelta||"N/A",t.horaSalidaEscalaVuelta||"N/A",t.horaLlegadaEscalaVuelta||"N/A",""])),ae.push([t.aerolineaVuelta||"N/A",t.vueloVuelta||"N/A",t.fechaFin?new Date(new Date(t.fechaFin).getTime()+new Date(t.fechaFin).getTimezoneOffset()*6e4).toLocaleDateString():"N/A",t.ruta2||"N/A",t.claseVuelta||"N/A",t.horaSalidaVuelta||"N/A",t.horaLlegadaVuelta||"N/A",t.recordVuelta||"N/A"]);const Ke=(p-a.left-a.right)/oe.length,et=p-a.left-a.right,w=12+8*ae.length;d+=5,e.rect(a.left,d-5,et,w,"S"),e.setFontSize(8),oe.forEach((l,o)=>{e.text(l,a.left+o*Ke,d)}),d+=5,ae.forEach((l,o)=>{l.forEach((n,s)=>{e.text(n,a.left+s*Ke,d+(o+1)*8)})}),d+=w-5;let H;const Ce="Esta cotizaci\xF3n est\xE1 sujeta a cambio y disponibilidad al momento de reservar (Sin servicio confirmado)",se=d,re=30;e.setDrawColor(0),e.rect(a.left,se,p-a.left-a.right,re),e.setFontSize(12),e.text("OBSERVACIONES:",a.left+2,se+6),e.setFontSize(10),e.text(Ce,a.left+2,se+15,{maxWidth:p-a.left-a.right-4}),d=se+re;const Te=d+10;e.setFontSize(8);const tt=`El pago de su plan se realizar\xE1 conforme a las siguientes condiciones:

Planes con inicio dentro de los 30 d\xEDas:  El pago total deber\xE1 efectuarse dentro de un d\xEDa h\xE1bil a partir de la fecha de env\xEDo de este documento.
Planes con inicio posterior a los 30 d\xEDas: El pago se realizar\xE1 en dos cuotas:
  * Primera cuota: 50% del valor total del plan, pagadero dentro de un d\xEDa h\xE1bil a partir de la fecha de env\xEDo de este documento.
  * Segunda cuota: 50% restante del valor total del plan, pagadero 30 d\xEDas antes de la fecha de inicio del plan.`,ce=e.splitTextToSize(tt,p-a.left-a.right-4);let de=18;ce.forEach(l=>{de+=e.getTextDimensions(l,{fontSize:8}).h}),d=L(e,d,de),e.setDrawColor(0),e.rect(a.left,Te,p-a.left-a.right,de),e.setFontSize(12),e.text("PLAZO DE PAGO:",a.left+2,Te+6),e.setFontSize(8),H=Te+15,ce.forEach(l=>{e.text(l,a.left+2,H,{maxWidth:p-a.left-a.right-4}),H+=e.getTextDimensions(l,{fontSize:8}).h}),d=Te+de;let qe=!1;e.setFontSize(8);const be=nt.split("\xBF");let Q=[];be.forEach(l=>{const o=e.splitTextToSize(l,p-a.left-a.right-4);Q=Q.concat(o)});let W=18;be.forEach(l=>{const o=e.splitTextToSize(l,p-a.left-a.right-4);for(let n=0;n<o.length;n++){const s=o[n];W+=e.getTextDimensions(s,{fontSize:8}).h,!s.endsWith(`
`)&&n<o.length-1&&(W+=e.getTextDimensions(" ",{fontSize:8}).h)}}),d=L(e,d,W),d===a.top&&(qe=!0);const ue=d+10;e.setDrawColor(0),e.rect(a.left,ue,p-a.left-a.right,W),e.setFontSize(12),e.text("INCLUYE:",a.left+2,ue+6),e.setFontSize(8),H=ue+15,Q.forEach(l=>{e.text(l,a.left+2,H,{maxWidth:p-a.left-a.right-4}),H+=e.getTextDimensions(l,{fontSize:8}).h}),d=ue+W;const Ie=i.split("\xBF");let G=[];Ie.forEach(l=>{const o=e.splitTextToSize(l,p-a.left-a.right-4);G=G.concat(o)});let U=18;Ie.forEach(l=>{const o=e.splitTextToSize(l,p-a.left-a.right-4);for(let n=0;n<o.length;n++){const s=o[n];U+=e.getTextDimensions(s,{fontSize:8}).h,!s.endsWith(`
`)&&n<o.length-1&&(U+=e.getTextDimensions(" ",{fontSize:8}).h)}}),d=L(e,d,U),qe||(d=a.top);const J=d+10;e.setDrawColor(0),e.rect(a.left,J,p-a.left-a.right,U),e.setFontSize(12),e.text("NO INCLUYE:",a.left+2,J+6),e.setFontSize(8),H=J+15,G.forEach(l=>{e.text(l,a.left+2,H,{maxWidth:p-a.left-a.right-4}),H+=e.getTextDimensions(l,{fontSize:8}).h}),d=J+U,e.addPage(),d=a.top,e.setFontSize(10),e.text("LIQUIDACI\xD3N:",a.left,d),d+=5;const h=d+5,c=2,u=6,g=(p-a.left-a.right)/6;e.setDrawColor(0);let X=0;e.setFontSize(7);let V=0;k.forEach(l=>{const o=h+V*u;_(o);const n=`Valor adul ${l.acomodacion}`;e.text(n,a.left+c,o+u/2,{baseline:"middle"});const s=Math.round(l.precioComisionableAdulto);e.text(s.toString(),a.left+g+c,o+u/2,{baseline:"middle"});const f=l.adultos;e.text(f.toString(),a.left+2*g+c,o+u/2,{baseline:"middle"});const C=Math.round(l.precioComisionableAdulto*l.adultos);if(e.text(C.toString(),a.left+3*g+c,o+u/2,{baseline:"middle"}),V===0){e.setFontSize(6);const I=ne==="Comisi\xF3n"?"BASE COMISI\xD3N":"BASE DE DESCUENTO";e.text(I,a.left+4*g+c,o+u/2,{baseline:"middle"}),e.setFontSize(7)}let M=C;if(l.ni\u00F1os>0&&(M+=Math.round(l.precioComisionableNino*l.ni\u00F1os)),X+=M,V++,l.ni\u00F1os>0){const I=h+V*u;_(I);const D=`Valor child ${l.acomodacion}`;e.text(D,a.left+c,I+u/2,{baseline:"middle"});const B=Math.round(l.precioComisionableNino);e.text(B.toString(),a.left+g+c,I+u/2,{baseline:"middle"});const Le=l.ni\u00F1os;e.text(Le.toString(),a.left+2*g+c,I+u/2,{baseline:"middle"});const z=Math.round(l.precioComisionableNino*l.ni\u00F1os);e.text(z.toString(),a.left+3*g+c,I+u/2,{baseline:"middle"}),V++}}),e.text(X.toString(),a.left+5*g+c,h+u/2,{baseline:"middle"}),d=h+V*u+10;const $=["TRANSPORTE NO COMISI","Q","YS","CO","TA","YS TA","TOTAL IMPUESTOS"],fe=[t.otros,t.combus,t.iva,t.tasa,t.ta,t.ivaTa,t.precioTrans];if(t.suplemento>0&&($.push("SUPLEMENTO"),fe.push(t.suplemento)),t.extra1)if(t.extra1.includes("*")){let l=t.extra1.split("*"),o=l[0],n=l[1];$.push("Valor Extra","Valor Extra2"),fe.push(o,n)}else{let l=t.extra1;$.push("Valor Extra"),fe.push(l)}$.forEach((l,o)=>{const n=d+o*u;_(n),e.text(l,a.left+c,n+u/2,{baseline:"middle"});const s=t.totalPasajeros,f=fe[o]||0,C=s!==0?Math.trunc(f/s):"";e.text(C.toString(),a.left+g+c,n+u/2,{baseline:"middle"});const M=s!==0?Math.trunc(s).toString():"";e.text(M,a.left+2*g+c,n+u/2,{baseline:"middle"});const I=f!==0?Math.trunc(f).toString():"";if(e.text(I,a.left+3*g+c,n+u/2,{baseline:"middle"}),l==="Q"){e.text("Porcentaje",a.left+4*g+c,n+u/2,{baseline:"middle"});const D=t.clientePorcentaje||0,B=Math.trunc(D).toString()+"%";e.text(B,a.left+5*g+c,n+u/2,{baseline:"middle"})}else if(l==="YS"){e.text("Valor Descuento",a.left+4*g+c,n+u/2,{baseline:"middle"});const D=t.valorDescuento||0,B=Math.trunc(D).toString();e.text(B,a.left+5*g+c,n+u/2,{baseline:"middle"}),ne==="Comisi\xF3n"&&[{label:`IVA(${R.porcentajeIva}%) (-)`,value:t.ivaValor},{label:`RTE FUENTE(${R.rteFuente}%) (+)`,value:t.rteFuente},{label:`RTE ICA(${R.rteIca}%) (+)`,value:t.rteIca},{label:"Total Comisi\xF3n",value:t.totalComision}].forEach((z,Y)=>{const it=n+(Y+1)*u;_(it),e.text(z.label,a.left+4*g+c,it+u/2,{baseline:"middle"}),e.text(z.value.toString(),a.left+5*g+c,it+u/2,{baseline:"middle"})})}}),d+=$.length*u,k.forEach(l=>{if(l.adultos>0){const o=d;_(o),e.text(`Valor total Adt ${l.acomodacion}`,a.left+c,o+u/2,{baseline:"middle"});const n=l.precioHabitacionAdulto||0,s=ie(n).format("$0,0");e.text(s,a.left+3*g+c,o+u/2,{baseline:"middle"}),d+=u}if(l.ni\u00F1os>0){const o=d;_(o),e.text(`Valor total Chd ${l.acomodacion}`,a.left+c,o+u/2,{baseline:"middle"});const n=l.precioHabitacionNino||0,s=ie(n).format("$0,0");e.text(s,a.left+3*g+c,o+u/2,{baseline:"middle"}),d+=u}}),e.setFontSize(8),d+=u,_(d),e.text("Valor total",a.left+c,d+u/2,{baseline:"middle"});const dt=t.precioBrutoTotal||0,ut=ie(dt).format("$0,0");e.text(ut,a.left+3*g+c,d+u/2,{baseline:"middle"}),e.text("Precio a pagar",a.left+4*g+c,d+u/2-2,{baseline:"middle"}),e.text("a Multidestinos",a.left+4*g+c,d+u/2+2,{baseline:"middle"});const ot=0,Be=parseFloat(t.totalPrecioCliente)||0,at=ot>0?Be+ot:Be,ft=ie(at).format("$0,0");e.text(ft,a.left+5*g+c,d+u/2,{baseline:"middle"}),d+=u+10;const me=a.left;let q=d+5;const Z=190;let he=30;e.setFontSize(7),e.setLineWidth(.5),e.setFontSize(6);const K=5,mt="PARA CONFIRMACIONES SE DEBE ENVIAR DEPOSITO DEL 50% DEL VALOR DEL PLAN Y EL SALDO 30 DIAS ANTES DE LA SALIDA, SI LA FECHA DE VIAJES CERCANA SE DEBE CANCELAR EL 100%. LOS SERVICIOS DEJADOS DE TOMAR NO SON REMBOLSABLES. LA CANCELACI\xD3N CON 18 DIAS ANTES DE VIAJE LA PENALIDAD SERA DEL 100% DEL VALOR DEL PLAN, LOS TIQUETES NO SON REEMBOLSABLE, NI ENDOSABLES, PENALIDAD POR CAMBIO (FECHA, NOMBRE, HORA, RUTAS) 200.000. ESTAS POLITICAS ESTAN PUBLICADAS DE MANERA CLARA Y ESPECIFICA EN NUESTRA PAGINA WWW.MULTIDESTINOSEXPRESS.COM. *TARIFAS SUJETA A CAMBIO Y DISPONIBILIDAD SIN PREVIO AVISO*",ge=e.splitTextToSize(mt,Z-10);he=20+ge.length*K,q+he>Se-a.bottom&&(e.addPage(),d=a.top),q=d,e.rect(me,d,Z,he),e.text("Deposito y Condiciones de Pago",me+5,q+3),ge.forEach((l,o)=>{e.text(l,me+5,q+10+o*K)}),j[0].facturaPara&&(d=q+10+ge.length*K,e.setFontSize(8),e.text("FACTURA A NOMBRE DE:",me+5,d),d+=K,e.text(j[0].facturaPara,me+5,d)),d+=he+5;const De=e.output("blob");return e.save(`cotizacion_${m}.pdf`),De}catch(L){console.error("Error al descargar cotizaci\xF3n:",L)}},async descargarLiquidacionCano(m,N){try{let L=function(o,n,s,f=10){return n+s>p-f?(o.addPage(),e.top):n},d=function(o){return o.map(n=>{const s=n.adultos,f=n.ni\u00F1os,C=`1x${s}`;return f>0?`${C} CHD`:C}).join(", ")},g=function(o){for(let n=0;n<=6;n++){const s=e.left+n*S;i.line(s,o,s,o+c)}i.line(e.left,o,a-e.right,o),i.line(e.left,o+c,a-e.right,o+c)};const[ee,b,te,A,ye]=await Promise.all([x.get(`https://backmultidestinos.onrender.com/habitacionCotizacion/${m}`),x.get(`https://backmultidestinos.onrender.com/cotizacion/${m}`),x.get(`https://backmultidestinos.onrender.com/ImpuestoCot/${m}`),x.get(`https://backmultidestinos.onrender.com/liquidacion/${N}`),x.get(`https://backmultidestinos.onrender.com/pasajero/${N}`)]);if(ee.status!==200||b.status!==200){console.error("Error al obtener datos de habitacionCotizacion o cotizacion");return}const t=b.data[0],O=te.data[0];console.log("impuesto",O);const k=ee.data;console.log("habitacion",k);const j=A.data;console.log("liquidacion",j);const We=ye.data;console.log("pasajero",We);const Oe=await x.get(`https://backmultidestinos.onrender.com/cliente/buscar/${t.cliente}`);console.log("clienteResponse",Oe);const P=Oe.data[0];console.log("clienteData",P);const R=P.tipoBase,ne=await x.get(`https://backmultidestinos.onrender.com/user/${t.CreadorCotizacion}`),Pe=ne.Data;console.log("vendedor",ne.data.nombreCompleto);const St={hotel:t.hotel,nombrePrograma:t.nombrePrograma,destino:t.destino},Ue=await x.post("https://backmultidestinos.onrender.com/hoteles/buscar",St),_e=Ue.data[0].incluye,nt=Ue.data[0].noIncluye,i=new Tt,e={top:10,bottom:10,left:10,right:10},a=i.internal.pageSize.width,p=i.internal.pageSize.height,Se=40,F={left:10,right:10,top:5,bottom:5},v=await new Promise((o,n)=>{const s=new Image;s.src="https://i.ibb.co/1sFJ7dT/imgAzul.png",s.onload=()=>o(s),s.onerror=n}),ze=v.width/v.height,lt=a/4-F.left-F.right,Ae=Math.min(100,lt),le=Ae/ze,$e=e.top+(Se-le)/2,st=`PBX(601)7621133
CALLE 64 No. 11-37 LOC 301
EMAIL: MULTIDESTINOS_EXPRESS@YAHOO.COM`,Ye=`Numero de Liquidacion: ${N}`;i.addImage(v,"PNG",e.left+F.left,$e,Ae,le);const ke=a-e.left-e.right-Ae-F.left-F.right-10;i.setFontSize(10),i.text(i.splitTextToSize(st,ke),e.left+Ae+F.left+F.right,e.top+10);const rt=a-e.right-i.getTextWidth(Ye)-F.right;i.setFontSize(12),i.setFont("Helvetica-Bold",12),i.text(Ye,rt,e.top+10),i.setDrawColor(0),i.rect(e.left,e.top,a-e.left-e.right,Se,"S"),i.setFontSize(10);const Qe=e.top+Se+10;i.setFontSize(10),i.text("SOLICITUD DE RESERVA:",e.left,Qe-4),i.setFontSize(8);const Ee=["FECHA SOLICITUD:","AGENCIA:","TEL\xC9FONO:","CONTACTO:","NIT:","VENDEDOR:"],Ne=[new Date(t.fechaCreacion).toLocaleDateString(),t.cliente.toString(),P.telefono?P.telefono.toString():"N/A",P.nit?P.nit.toString():"N/A",P.nit?P.nit.toString():"N/A",ne.data.nombreCompleto?ne.data.nombreCompleto.toString():"N/A"],Re=6,Fe=(a-e.left-e.right)/Re;let y=e.left,r=Qe;for(let o=0;o<Ee.length;o++){i.text(Ee[o],y,r);const n=Ne[o]!==void 0?Ne[o]:"N/A",s=i.splitTextToSize(n,Fe-2);i.text(s,y,r+5),y+=Fe,((o+1)%Re===0||o===Ee.length-1)&&(r+=15,y=e.left)}const ct=d(k),Ge=["NOCHES:","HOTEL:","PLAN:","DESTINO:","DIRECCION:","ACOMODACI\xD3N:"],xe=[t.noches?t.noches.toString():"N/A",t.hotel?t.hotel.toString():"N/A",t.plan?t.plan.toString():"N/A",t.destino?t.destino.toString():"N/A",t.direccion?t.direccion.toString():"N/A",ct.toString()];console.log("campso2",xe);const ve=6,Je=(a-e.left-e.right)/ve;r+=1;for(let o=0;o<Ge.length;o++){i.text(Ge[o],y,r);const n=xe[o]!==void 0?xe[o]:"N/A",s=i.splitTextToSize(n,Je-2);i.text(s,y,r+5),y+=Je}r+=1,i.setFontSize(10),i.text("PASAJEROS: ",e.left,r+12),r+=20;const we=["NOMBRE","DOCUMENTO","F. NACIMIENTO","EDAD"],Ve=We.map(o=>{const n=new Date(o.fechaNacimiento),s=new Date;let f=s.getFullYear()-n.getFullYear();const C=s.getMonth()-n.getMonth();return(C<0||C===0&&s.getDate()<n.getDate())&&f--,[o.nombre,o.numeroDocumento,n.toLocaleDateString(),f]}),Me=(a-e.left-e.right)/we.length,Xe=a-e.left-e.right,Ze=10+8*Ve.length;i.rect(e.left,r,Xe,Ze,"S"),i.setFontSize(8),we.forEach((o,n)=>{i.text(o,e.left+5+n*Me,r+5)}),r+=10,Ve.forEach((o,n)=>{o.forEach((s,f)=>{i.text(s.toString(),e.left+5+f*Me,r+n*8)})}),r+=Ze-15,r+=1,i.setFontSize(10),i.text("ITINERARIO: ",e.left,r+12),r+=20;const He=["AEROLINEA","VUELO","FECHA","RUTA","CLASE","HR SALIDA","HR LLEGADA","RECORD"],oe=[[t.aerolineaIda||"N/A",t.vueloIda||"N/A",t.fechaInicio?new Date(new Date(t.fechaInicio).getTime()+new Date(t.fechaInicio).getTimezoneOffset()*6e4).toLocaleDateString():"N/A",t.ruta1||"N/A",t.claseIda||"N/A",t.horaSalidaIda||"N/A",t.horaLlegadaIda||"N/A",t.recordIda||"N/A"]];t.aerolineaEscalaIda!=null&&(oe.push([t.aerolineaEscalaIda||"N/A",t.vueloEscalaIda||"N/A",t.fechaInicio?new Date(new Date(t.fechaInicio).getTime()+new Date(t.fechaInicio).getTimezoneOffset()*6e4).toLocaleDateString():"N/A","Escala Ida",t.claseEscalaIda||"N/A",t.horaSalidaEscalaIda||"N/A",t.horaLlegadaEscalaIda||"N/A",""]),oe.push([t.aerolineaEscalaVuelta||"N/A",t.vueloEscalaVuelta||"N/A",t.fechaFin?new Date(new Date(t.fechaFin).getTime()+new Date(t.fechaFin).getTimezoneOffset()*6e4).toLocaleDateString():"N/A","Escala Vuelta",t.claseEscalaVuelta||"N/A",t.horaSalidaEscalaVuelta||"N/A",t.horaLlegadaEscalaVuelta||"N/A",""])),oe.push([t.aerolineaVuelta||"N/A",t.vueloVuelta||"N/A",t.fechaFin?new Date(new Date(t.fechaFin).getTime()+new Date(t.fechaFin).getTimezoneOffset()*6e4).toLocaleDateString():"N/A",t.ruta2||"N/A",t.claseVuelta||"N/A",t.horaSalidaVuelta||"N/A",t.horaLlegadaVuelta||"N/A",t.recordVuelta||"N/A"]);const ae=(a-e.left-e.right)/He.length,Ke=a-e.left-e.right,et=10+8*oe.length;i.rect(e.left,r,Ke,et,"S"),i.setFontSize(8),He.forEach((o,n)=>{i.text(o,e.left+n*ae,r+5)}),r+=10,oe.forEach((o,n)=>{o.forEach((s,f)=>{i.text(s,e.left+f*ae,r+n*8)})}),r+=et-8;let w;const H="Esta cotizaci\xF3n est\xE1 sujeta a cambio y disponibilidad al momento de reservar (Sin servicio confirmado)",Ce=r,se=30;i.setDrawColor(0),i.rect(e.left,Ce,a-e.left-e.right,se),i.setFontSize(12),i.text("OBSERVACIONES:",e.left+2,Ce+6),i.setFontSize(10),i.text(H,e.left+2,Ce+15,{maxWidth:a-e.left-e.right-4}),r=Ce+se;const re=r+10;i.setFontSize(8);const Te=`El pago de su plan se realizar\xE1 conforme a las siguientes condiciones:

Planes con inicio dentro de los 30 d\xEDas:  El pago total deber\xE1 efectuarse dentro de un d\xEDa h\xE1bil a partir de la fecha de env\xEDo de este documento.
Planes con inicio posterior a los 30 d\xEDas: El pago se realizar\xE1 en dos cuotas:
  * Primera cuota: 50% del valor total del plan, pagadero dentro de un d\xEDa h\xE1bil a partir de la fecha de env\xEDo de este documento.
  * Segunda cuota: 50% restante del valor total del plan, pagadero 30 d\xEDas antes de la fecha de inicio del plan.`,tt=i.splitTextToSize(Te,a-e.left-e.right-4);let ce=18;tt.forEach(o=>{ce+=i.getTextDimensions(o,{fontSize:8}).h}),r=L(i,r,ce),i.setDrawColor(0),i.rect(e.left,re,a-e.left-e.right,ce),i.setFontSize(12),i.text("PLAZO DE PAGO:",e.left+2,re+6),i.setFontSize(8),w=re+15,tt.forEach(o=>{i.text(o,e.left+2,w,{maxWidth:a-e.left-e.right-4}),w+=i.getTextDimensions(o,{fontSize:8}).h}),r=re+ce;let de=!1;i.setFontSize(8);const qe=_e.split("\xBF");let be=[];qe.forEach(o=>{const n=i.splitTextToSize(o,a-e.left-e.right-4);be=be.concat(n)});let Q=18;qe.forEach(o=>{const n=i.splitTextToSize(o,a-e.left-e.right-4);for(let s=0;s<n.length;s++){const f=n[s];Q+=i.getTextDimensions(f,{fontSize:8}).h,!f.endsWith(`
`)&&s<n.length-1&&(Q+=i.getTextDimensions(" ",{fontSize:8}).h)}}),r=L(i,r,Q),r===e.top&&(de=!0);const W=r+10;i.setDrawColor(0),i.rect(e.left,W,a-e.left-e.right,Q),i.setFontSize(12),i.text("INCLUYE:",e.left+2,W+6),i.setFontSize(8),w=W+15,be.forEach(o=>{i.text(o,e.left+2,w,{maxWidth:a-e.left-e.right-4}),w+=i.getTextDimensions(o,{fontSize:8}).h}),r=W+Q;const ue=nt.split("\xBF");let Ie=[];ue.forEach(o=>{const n=i.splitTextToSize(o,a-e.left-e.right-4);Ie=Ie.concat(n)});let G=18;ue.forEach(o=>{const n=i.splitTextToSize(o,a-e.left-e.right-4);for(let s=0;s<n.length;s++){const f=n[s];G+=i.getTextDimensions(f,{fontSize:8}).h,!f.endsWith(`
`)&&s<n.length-1&&(G+=i.getTextDimensions(" ",{fontSize:8}).h)}}),r=L(i,r,G),de||(r=e.top);const U=r+10;i.setDrawColor(0),i.rect(e.left,U,a-e.left-e.right,G),i.setFontSize(12),i.text("NO INCLUYE:",e.left+2,U+6),i.setFontSize(8),w=U+15,Ie.forEach(o=>{i.text(o,e.left+2,w,{maxWidth:a-e.left-e.right-4}),w+=i.getTextDimensions(o,{fontSize:8}).h}),r=U+G,i.addPage(),r=e.top,i.setFontSize(10),i.text("LIQUIDACI\xD3N:",e.left,r),r+=5;const J=r+5,h=2,c=6,S=(a-e.left-e.right)/6;i.setDrawColor(0);let _=0;i.setFontSize(7);let X=0;k.forEach(o=>{const n=J+X*c;g(n);const s=`Valor adul ${o.acomodacion}`;i.text(s,e.left+h,n+c/2,{baseline:"middle"});const f=Math.round(o.precioComisionableAdulto);i.text(f.toString(),e.left+S+h,n+c/2,{baseline:"middle"});const C=o.adultos;i.text(C.toString(),e.left+2*S+h,n+c/2,{baseline:"middle"});const M=Math.round(o.precioComisionableAdulto*o.adultos);if(i.text(M.toString(),e.left+3*S+h,n+c/2,{baseline:"middle"}),X===0){i.setFontSize(6);const D=R==="Comisi\xF3n"?"BASE COMISI\xD3N":"BASE DE DESCUENTO";i.text(D,e.left+4*S+h,n+c/2,{baseline:"middle"}),i.setFontSize(7)}let I=M;if(o.ni\u00F1os>0&&(I+=Math.round(o.precioComisionableNino*o.ni\u00F1os)),_+=I,X++,o.ni\u00F1os>0){const D=J+X*c;g(D);const B=`Valor child ${o.acomodacion}`;i.text(B,e.left+h,D+c/2,{baseline:"middle"});const Le=Math.round(o.precioComisionableNino);i.text(Le.toString(),e.left+S+h,D+c/2,{baseline:"middle"});const z=o.ni\u00F1os;i.text(z.toString(),e.left+2*S+h,D+c/2,{baseline:"middle"});const Y=Math.round(o.precioComisionableNino*o.ni\u00F1os);i.text(Y.toString(),e.left+3*S+h,D+c/2,{baseline:"middle"}),X++}}),i.text(_.toString(),e.left+5*S+h,J+c/2,{baseline:"middle"}),r=J+X*c+10;const V=["TRANSPORTE NO COMI","Q","YS","CO","TA","YS TA","defensaCivil","alcaldiaNacional","alcaldiaExtranjero","pqsNaturalesExtranjero","pqsNaturales25a65","pqsNaturales5a24","cormacarenaExtranjero","cormacarena5a11","cormacarena12a65"],$=[t.otros,t.combus,t.iva,t.tasa,t.ta,t.ivaTa,O.defensaCivil_Total,O.alcaldiaNacional_Total,O.alcaldiaExtranjero_Total,O.pqsNaturalesExtranjero_Total,O.pqsNaturales25a65_Total,O.pqsNaturales5a24_Total,O.cormacarenaExtranjero_Total,O.cormacarena5a11_Total,O.cormacarena12a65_Total,t.precioTrans],fe=["alcaldiaNacional","alcaldiaExtranjero","pqsNaturalesExtranjero","pqsNaturales25a65","pqsNaturales5a24","cormacarenaExtranjero","cormacarena5a11","cormacarena12a65"],dt={defensaCivil:"Defensa Civil",alcaldiaNacional:"Alcald\xEDa Nacional",alcaldiaExtranjero:"Alcald\xEDa Extranjero",pqsNaturalesExtranjero:"PQS. Naturales Extranjero",pqsNaturales25a65:"PQS. Naturales 25 a 65",pqsNaturales5a24:"PQS. Naturales 5 a 24",cormacarenaExtranjero:"Cormacarena Extranjero",cormacarena5a11:"Cormacarena 5 a 11",cormacarena12a65:"Cormacarena 12 a 65"};if(t.suplemento>0&&(V.push("SUPLEMENTO"),$.push(t.suplemento)),t.extra1)if(t.extra1.includes("*")){let o=t.extra1.split("*"),n=o[0],s=o[1];V.push("Valor Extra","Valor Extra2"),$.push(n,s)}else{let o=t.extra1;V.push("Valor Extra"),$.push(o)}V.forEach((o,n)=>{const s=r+n*c;g(s);const f=dt[o]||o;i.text(f,e.left+h,s+c/2,{baseline:"middle"});const C=t.totalPasajeros,M=$[n]||0;let I="";if(fe.includes(o)){const z=`${o}_numeroPersonas`,Y=O[z]||0;I=Y!==0?Math.trunc(M/Y):""}else I=C!==0?Math.trunc(M/C):"";i.text(I.toString(),e.left+S+h,s+c/2,{baseline:"middle"});const D=C!==0?Math.trunc(C).toString():"";let B="";if(fe.includes(o)){const z=`${o}_numeroPersonas`;B=O[z]||""}else B=D;i.text(B,e.left+2*S+h,s+c/2,{baseline:"middle"});const Le=M!==0?Math.trunc(M).toString():"";if(i.text(Le,e.left+3*S+h,s+c/2,{baseline:"middle"}),o==="Q"){i.text("Porcentaje",e.left+4*S+h,s+c/2,{baseline:"middle"});const z=t.clientePorcentaje||0,Y=Math.trunc(z).toString()+"%";i.text(Y,e.left+5*S+h,s+c/2,{baseline:"middle"})}else if(o==="YS"){i.text("Valor Descuento",e.left+4*S+h,s+c/2,{baseline:"middle"});const z=t.valorDescuento||0,Y=Math.trunc(z).toString();i.text(Y,e.left+5*S+h,s+c/2,{baseline:"middle"}),R==="Comisi\xF3n"&&[{label:`IVA(${P.porcentajeIva}%) (-)`,value:t.ivaValor},{label:`RTE FUENTE(${P.rteFuente}%) (+)`,value:t.rteFuente},{label:`RTE ICA(${P.rteIca}%) (+)`,value:t.rteIca},{label:"Total Comisi\xF3n",value:t.totalComision}].forEach((At,bt)=>{const ht=s+(bt+1)*c;g(ht),i.text(At.label,e.left+4*S+h,ht+c/2,{baseline:"middle"}),i.text(At.value.toString(),e.left+5*S+h,ht+c/2,{baseline:"middle"})})}}),r+=V.length*c,k.forEach(o=>{if(o.adultos>0){const n=r;g(n),i.text(`Valor total Adt ${o.acomodacion}`,e.left+h,n+c/2,{baseline:"middle"});const s=o.precioHabitacionAdulto||0,f=ie(s).format("$0,0");i.text(f,e.left+3*S+h,n+c/2,{baseline:"middle"}),r+=c}if(o.ni\u00F1os>0){const n=r;g(n),i.text(`Valor total Chd ${o.acomodacion}`,e.left+h,n+c/2,{baseline:"middle"});const s=o.precioHabitacionNino||0,f=ie(s).format("$0,0");i.text(f,e.left+3*S+h,n+c/2,{baseline:"middle"}),r+=c}}),i.setFontSize(8),r+=c,g(r),i.text("Valor total",e.left+h,r+c/2,{baseline:"middle"});const ut=t.precioBrutoTotal||0,ot=ie(ut).format("$0,0");i.text(ot,e.left+3*S+h,r+c/2,{baseline:"middle"}),i.text("Precio a pagar",e.left+4*S+h,r+c/2-2,{baseline:"middle"}),i.text("a Multidestinos",e.left+4*S+h,r+c/2+2,{baseline:"middle"});const Be=parseFloat(t.suplemento)||0,at=parseFloat(t.totalPrecioCliente)||0,ft=Be>0?at+Be:at,me=ie(ft).format("$0,0");i.text(me,e.left+5*S+h,r+c/2,{baseline:"middle"}),r+=c+10;const q=e.left;let Z=r+5;const he=190;let K=30;i.setFontSize(7),i.setLineWidth(.5);const mt="PARA CONFIRMACIONES SE DEBE ENVIAR DEPOSITO DEL 50% DEL VALOR DEL PLAN Y EL SALDO 30 DIAS ANTES DE LA SALIDA, SI LA FECHA DE VIAJES CERCANA SE DEBE CANCELAR EL 100%. LOS SERVICIOS DEJADOS DE TOMAR NO SON REMBOLSABLES. LA CANCELACI\xD3N CON 18 DIAS ANTES DE VIAJE LA PENALIDAD SERA DEL 100% DEL VALOR DEL PLAN, LOS TIQUETES NO SON REEMBOLSABLE, NI ENDOSABLES, PENALIDAD POR CAMBIO (FECHA, NOMBRE, HORA, RUTAS) 200.000. ESTAS POLITICAS ESTAN PUBLICADAS DE MANERA CLARA Y ESPECIFICA EN NUESTRA PAGINA WWW.MULTIDESTINOSEXPRESS.COM. *TARIFAS SUJETA A CAMBIO Y DISPONIBILIDAD SIN PREVIO AVISO*",ge=i.splitTextToSize(mt,he-10);Z+K>p-e.bottom&&(i.addPage(),r=e.top,Z=r+5),i.text("Deposito y Condiciones de Pago",q+5,Z+3),i.setFontSize(6);const De=5;K=20+ge.length*De,i.rect(q,Z,he,K),ge.forEach((o,n)=>{i.text(o,q+5,Z+10+n*De)}),j[0].facturaPara&&(r=Z+10+ge.length*De,i.setFontSize(8),i.text("FACTURA A NOMBRE DE:",q+5,r),r+=De,i.text(j[0].facturaPara,q+5,r)),r+=K+5;const l=i.output("blob");return i.save(`cotizacion_${m}.pdf`),l}catch(L){console.error("Error al descargar cotizaci\xF3n:",L)}}},async mounted(){try{const m=await x.get("https://backmultidestinos.onrender.com/liquidacion");this.rows=m.data}catch(m){console.error("Error al obtener las liquidaciones:",m)}}},qt={class:"row q-col-gutter-md"},Bt={class:"col-12"},jt=pe("div",{class:"text-h6"},"Liquidaciones",-1),yt={class:"row"},Wt={class:"col-6"},Ut={class:"col-6"},_t=pe("div",{class:"text-h6"},"Factura a otro nombre",-1);function $t(m,N,L,ee,b,te){return Lt(),Ot(Pt,{padding:""},{default:T(()=>[pe("div",qt,[pe("div",Bt,[E(Ct,null,{default:T(()=>[E(je,null,{default:T(()=>[jt]),_:1}),E(je,null,{default:T(()=>[pe("div",yt,[pe("div",Wt,[E(Et,{modelValue:b.filterId,"onUpdate:modelValue":N[0]||(N[0]=A=>b.filterId=A),label:"Filtrar por ID de Cotizaci\xF3n",filled:"",dense:"",clearable:""},null,8,["modelValue"])]),pe("div",Ut,[E(zt,{modelValue:b.filterStatus,"onUpdate:modelValue":N[1]||(N[1]=A=>b.filterStatus=A),options:b.statusOptions,label:"Filtrar por Status",filled:"",dense:"",clearable:"","emit-value":"","map-options":""},null,8,["modelValue","options"])])])]),_:1}),E(je,null,{default:T(()=>[E(Rt,{title:"Lista de Liquidaciones",rows:te.filteredRows,columns:b.columns,"row-key":"id"},{"body-cell-tieneImpuestos":T(A=>[E(gt,{props:A},{default:T(()=>[Nt(xt(A.row.impuestosLiq==="1"?"S\xED":"No"),1)]),_:2},1032,["props"])]),"body-cell-status":T(A=>[E(gt,{props:A},{default:T(()=>[E(Ft,{color:te.chipColor(A.row.status),"text-color":"white"},{default:T(()=>[Nt(xt(A.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-acciones":T(A=>[E(gt,{props:A},{default:T(()=>[E(pt,{onClick:ye=>te.mostrarDialogoFactura(A.row),color:"primary",label:"Descargar Liquidacion"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])]),E(Vt,{modelValue:b.mostrarDialogo,"onUpdate:modelValue":N[3]||(N[3]=A=>b.mostrarDialogo=A)},{default:T(()=>[E(Ct,null,{default:T(()=>[E(je,null,{default:T(()=>[_t]),_:1}),E(je,{class:"q-pt-none"},{default:T(()=>[E(Et,{modelValue:b.nombreFactura,"onUpdate:modelValue":N[2]||(N[2]=A=>b.nombreFactura=A),label:"Nombre para la factura"},null,8,["modelValue"])]),_:1}),E(vt,{align:"right"},{default:T(()=>[wt(E(pt,{flat:"",label:"Cancelar",color:"primary"},null,512),[[Mt]]),E(pt,{flat:"",label:"Aceptar",color:"primary",onClick:te.procesarDescarga},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Gt=It(Ht,[["render",$t]]);export{Gt as default};

import{c as P,a as x,h as C,M as Z,E as L,F as T,d as k,g as G,a2 as O,aA as g,a4 as c,a5 as J,a6 as l,au as H,a9 as s,a7 as o,a8 as m,ah as I,aw as V,av as _,N as E,aB as R,ay as b,ae as u,aC as U,az as p,ax as w,aD as A,aE as Q,aF as z,ai as B,ag as f,aG as D,aH as v,aj as S,aa as h,aI as F,ak as K,al as W}from"./index.bd5cde0f.js";import{Q as N}from"./QSpace.53b2fd44.js";import{Q as M}from"./QTooltip.06b4bfab.js";const X=["top","middle","bottom"];var Y=P({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:a=>X.includes(a)}},setup(a,{slots:r}){const d=x(()=>a.align!==void 0?{verticalAlign:a.align}:null),y=x(()=>{const t=a.outline===!0&&a.color||a.textColor;return`q-badge flex inline items-center no-wrap q-badge--${a.multiLine===!0?"multi":"single"}-line`+(a.outline===!0?" q-badge--outline":a.color!==void 0?` bg-${a.color}`:"")+(t!==void 0?` text-${t}`:"")+(a.floating===!0?" q-badge--floating":"")+(a.rounded===!0?" q-badge--rounded":"")+(a.transparent===!0?" q-badge--transparent":"")});return()=>C("div",{class:y.value,style:d.value,role:"status","aria-label":a.label},Z(r.default,a.label!==void 0?[a.label]:[]))}}),$=P({name:"QBanner",props:{...L,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(a,{slots:r}){const{proxy:{$q:d}}=G(),y=T(a,d),t=x(()=>"q-banner row items-center"+(a.dense===!0?" q-banner--dense":"")+(y.value===!0?" q-banner--dark q-dark":"")+(a.rounded===!0?" rounded-borders":"")),i=x(()=>`q-banner__actions row items-center justify-end col-${a.inlineActions===!0?"auto":"all"}`);return()=>{const e=[C("div",{class:"q-banner__avatar col-auto row items-center self-start"},k(r.avatar)),C("div",{class:"q-banner__content col text-body2"},k(r.default))],n=k(r.action);return n!==void 0&&e.push(C("div",{class:i.value},n)),C("div",{class:t.value+(a.inlineActions===!1&&n!==void 0?" q-banner--top-padding":""),role:"alert"},e)}}});const ee={data(){return{zona:"",zonaEditar:"",nombreCompleto:"",usuario:"",contrase\u00F1a:"",email:"",usuarios:[],nombreCompletoEditar:"",usuarioEditar:"",rolEditar:"",rol:"",contrase\u00F1aEditar:"",emailEditar:"",usuarioEditandoId:null,confirmarEliminarDialog:!1,usuarioAEliminarId:null,rolesDisponibles:["administrador","Comercial 1","Comercial 2","Contable","Supervisor","Asesor"],coloresRoles:{administrador:"deep-purple","Comercial 1":"teal","Comercial 2":"green",Contable:"blue",Supervisor:"orange",Asesor:"red"},iconosRoles:{administrador:"admin_panel_settings","Comercial 1":"sell","Comercial 2":"add_business",Contable:"account_balance",Supervisor:"supervisor_account",Asesor:"support_agent"},mostrarModalAgregar:!1,mostrarModalEditar:!1}},computed:{formValido(){return this.nombreCompleto&&this.usuario&&this.contrase\u00F1a&&this.rol&&(this.rol!=="Asesor"||this.rol==="Asesor"&&this.zona)&&this.email},formValidoEditar(){return this.nombreCompletoEditar&&this.usuarioEditar&&this.contrase\u00F1aEditar&&this.rolEditar&&(this.rolEditar!=="Asesor"||this.rolEditar==="Asesor"&&this.zonaEditar)&&this.emailEditar}},mounted(){this.cargarUsuarios()},methods:{obtenerColorRol(a){return this.coloresRoles[a]||"grey"},obtenerIconoRol(a){return this.iconosRoles[a]||"person"},filtrarUsuariosPorRol(a){return this.usuarios.filter(r=>r.rol===a)},getInitials(a){return a?a.split(" ").map(r=>r.charAt(0)).join("").toUpperCase().substring(0,2):"?"},confirmarEliminar(a){this.usuarioAEliminarId=a,this.confirmarEliminarDialog=!0},eliminarUsuarioConfirmado(){this.eliminarUsuario(this.usuarioAEliminarId),this.usuarioAEliminarId=null},checkZonaFieldEditar(){this.rolEditar!=="Asesor"&&(this.zonaEditar="")},checkZonaField(){this.rol!=="Asesor"&&(this.zona="")},cargarUsuarios(){fetch("https://backmultidestinos.onrender.com/user/").then(a=>{if(!a.ok)throw new Error("Error en la respuesta del servidor: "+a.status);return a.json()}).then(a=>{this.usuarios=a}).catch(a=>{console.error("Error al cargar usuarios:",a),g.create({type:"negative",message:"Error al cargar usuarios: "+a.message,position:"top",timeout:2500})})},submitForm(){const a="1",r={nombreCompleto:this.nombreCompleto,usuario:this.usuario,contrasena:this.contrase\u00F1a,activo:a,rol:this.rol,zona:this.zona?this.zona:"",email:this.email};fetch("https://backmultidestinos.onrender.com/user/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(d=>{if(!d.ok)throw new Error("Error en la respuesta del servidor: "+d.status);return d.json()}).then(d=>{console.log("Usuario agregado:",d),g.create({type:"positive",message:"Usuario agregado correctamente",position:"top",icon:"check_circle",timeout:2500}),this.cargarUsuarios(),this.limpiarFormulario(),this.mostrarModalAgregar=!1}).catch(d=>{console.error("Error al enviar datos:",d),g.create({type:"negative",message:"Error al agregar usuario: "+d.message,position:"top",timeout:2500})})},editarUsuario(a){this.nombreCompletoEditar=a.nombreCompleto,this.usuarioEditar=a.usuario,this.rolEditar=a.rol,this.usuarioEditandoId=a.id,this.zonaEditar=a.zona||"",this.contrase\u00F1aEditar="",this.emailEditar=a.email||"",this.mostrarModalEditar=!0},editarUsuarioSubmit(){if(!this.formValidoEditar){g.create({type:"warning",message:"Complete todos los campos requeridos",position:"top",timeout:2500});return}const a={id:this.usuarioEditandoId,nombreCompleto:this.nombreCompletoEditar,usuario:this.usuarioEditar,contrasena:this.contrase\u00F1aEditar,rol:this.rolEditar,zona:this.zonaEditar||"",activo:"1",email:this.emailEditar};fetch(`https://backmultidestinos.onrender.com/user/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error("Error en la respuesta del servidor: "+r.status);return r.json()}).then(r=>{console.log("Usuario editado:",r),this.cargarUsuarios(),this.limpiarFormularioEditar(),this.mostrarModalEditar=!1,g.create({type:"positive",message:"Usuario editado correctamente",icon:"check_circle",position:"top",timeout:2500})}).catch(r=>{console.error("Error al editar usuario:",r),g.create({type:"negative",message:"Error al editar usuario: "+r.message,position:"top",timeout:2500})})},eliminarUsuario(a){fetch(`https://backmultidestinos.onrender.com/user/${a}`,{method:"DELETE"}).then(r=>{if(!r.ok)throw new Error("Error en la respuesta del servidor: "+r.status);this.usuarios=this.usuarios.filter(d=>d.id!==a),console.log("Usuario eliminado con ID:",a),g.create({type:"positive",message:"Usuario eliminado correctamente",icon:"check_circle",position:"top",timeout:2500})}).catch(r=>{console.error("Error al eliminar usuario:",r),g.create({type:"negative",message:"Error al eliminar usuario: "+r.message,position:"top",timeout:2500})})},limpiarFormulario(){this.nombreCompleto="",this.usuario="",this.contrase\u00F1a="",this.rol="",this.zona="",this.email=""},limpiarFormularioEditar(){this.nombreCompletoEditar="",this.usuarioEditar="",this.contrase\u00F1aEditar="",this.rolEditar="",this.zonaEditar="",this.emailEditar="",this.usuarioEditandoId=null}}},q=a=>(K("data-v-60126792"),a=a(),W(),a),oe={class:"container-wrapper q-pa-md"},ae={class:"header-container q-mb-lg"},re={class:"row items-center justify-between full-width"},te=q(()=>s("h4",{class:"q-ma-none text-weight-bold text-primary"}," Gesti\xF3n de Usuarios ",-1)),le=q(()=>s("div",{class:"text-h6"},"Agregar Nuevo Usuario",-1)),se={class:"row q-col-gutter-md"},ie={class:"col-12"},ne={class:"col-12 col-md-6"},de={class:"col-12 col-md-6"},ue={class:"col-12 col-md-6"},ce={key:0,class:"col-12 col-md-6"},me={class:"col-12 col-md-6"},pe={class:"row justify-end q-mt-lg"},he=q(()=>s("div",{class:"text-h6"},"Editar Usuario",-1)),ge={class:"row q-col-gutter-md"},be={class:"col-12"},fe={class:"col-12 col-md-6"},_e={class:"col-12 col-md-6"},Ee={class:"col-12 col-md-6"},ve={key:0,class:"col-12 col-md-6"},Ce={class:"col-12 col-md-6"},ye={class:"row justify-end q-mt-lg"},Ve={class:"roles-container"},Ue={class:"row items-center q-py-sm q-px-md"},we={class:"row q-col-gutter-md q-mt-md q-pa-sm"},xe=["src"],qe={class:"text-h6 q-mt-sm"},ke={class:"text-subtitle2 text-grey-8"},Ae={class:"text-subtitle2 text-grey-8"},ze={key:0,class:"q-mt-sm"},Se={key:0,class:"col-12"},Ie=q(()=>s("span",{class:"q-ml-sm text-h6"},"Confirmar eliminaci\xF3n",-1));function Re(a,r,d,y,t,i){return c(),J(H,{class:"custom-page-bg"},{default:l(()=>[s("div",oe,[s("div",ae,[s("div",re,[te,o(m,{onClick:r[0]||(r[0]=e=>t.mostrarModalAgregar=!0),label:"Agregar Usuario",class:"add-button",icon:"person_add",color:"primary",unelevated:"",rounded:""})]),o(I,{class:"q-mt-sm",color:"blue-grey-2"})]),o(A,{modelValue:t.mostrarModalAgregar,"onUpdate:modelValue":r[7]||(r[7]=e=>t.mostrarModalAgregar=e),persistent:"","content-css":"max-width: 500px;"},{default:l(()=>[o(V,{class:"modal-card"},{default:l(()=>[o(_,{class:"row items-center bg-primary text-white"},{default:l(()=>[le,o(N),E(o(m,{icon:"close",flat:"",round:"",dense:""},null,512),[[v]])]),_:1}),o(_,{class:"q-pa-md"},{default:l(()=>[o(R,{onSubmit:i.submitForm},{default:l(()=>[s("div",se,[s("div",ie,[o(b,{label:"Nombre completo",modelValue:t.nombreCompleto,"onUpdate:modelValue":r[1]||(r[1]=e=>t.nombreCompleto=e),rules:[e=>!!e||"El nombre completo es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"person"})]),_:1},8,["modelValue","rules"])]),s("div",ne,[o(b,{label:"Usuario",modelValue:t.usuario,"onUpdate:modelValue":r[2]||(r[2]=e=>t.usuario=e),rules:[e=>!!e||"El usuario es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"account_circle"})]),_:1},8,["modelValue","rules"])]),s("div",de,[o(b,{label:"Contrase\xF1a",modelValue:t.contrase\u00F1a,"onUpdate:modelValue":r[3]||(r[3]=e=>t.contrase\u00F1a=e),type:"password",rules:[e=>!!e||"La contrase\xF1a es obligatoria"],filled:""},{prepend:l(()=>[o(u,{name:"vpn_key"})]),_:1},8,["modelValue","rules"])]),s("div",ue,[o(U,{label:"Rol",modelValue:t.rol,"onUpdate:modelValue":r[4]||(r[4]=e=>t.rol=e),options:t.rolesDisponibles,rules:[e=>!!e||"El rol es obligatorio"],onInput:i.checkZonaField,filled:""},{prepend:l(()=>[o(u,{name:"assignment_ind"})]),_:1},8,["modelValue","options","rules","onInput"])]),t.rol==="Asesor"?(c(),p("div",ce,[o(U,{label:"Zona",modelValue:t.zona,"onUpdate:modelValue":r[5]||(r[5]=e=>t.zona=e),options:["Zona 1","Zona 2"],rules:[e=>!!e||"La zona es obligatoria"],filled:""},{prepend:l(()=>[o(u,{name:"place"})]),_:1},8,["modelValue","rules"])])):w("",!0),s("div",me,[o(b,{label:"Correo",modelValue:t.email,"onUpdate:modelValue":r[6]||(r[6]=e=>t.email=e),rules:[e=>!!e||"El correo es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"email"})]),_:1},8,["modelValue","rules"])])]),s("div",pe,[E(o(m,{outline:"",label:"Cancelar",color:"negative",class:"q-mr-sm"},null,512),[[v]]),o(m,{type:"submit",label:"Registrar Usuario",color:"primary",disable:!i.formValido,unelevated:""},null,8,["disable"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(A,{modelValue:t.mostrarModalEditar,"onUpdate:modelValue":r[14]||(r[14]=e=>t.mostrarModalEditar=e),persistent:"","content-css":"max-width: 600px;"},{default:l(()=>[o(V,{class:"modal-card"},{default:l(()=>[o(_,{class:"row items-center bg-primary text-white"},{default:l(()=>[he,o(N),E(o(m,{icon:"close",flat:"",round:"",dense:""},null,512),[[v]])]),_:1}),o(_,{class:"q-pa-md"},{default:l(()=>[o(R,{onSubmit:i.editarUsuarioSubmit},{default:l(()=>[s("div",ge,[s("div",be,[o(b,{label:"Nombre completo",modelValue:t.nombreCompletoEditar,"onUpdate:modelValue":r[8]||(r[8]=e=>t.nombreCompletoEditar=e),rules:[e=>!!e||"El nombre completo es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"person"})]),_:1},8,["modelValue","rules"])]),s("div",fe,[o(b,{label:"Usuario",modelValue:t.usuarioEditar,"onUpdate:modelValue":r[9]||(r[9]=e=>t.usuarioEditar=e),rules:[e=>!!e||"El usuario es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"account_circle"})]),_:1},8,["modelValue","rules"])]),s("div",_e,[o(b,{label:"Contrase\xF1a",modelValue:t.contrase\u00F1aEditar,"onUpdate:modelValue":r[10]||(r[10]=e=>t.contrase\u00F1aEditar=e),type:"password",rules:[e=>!!e||"La contrase\xF1a es obligatoria"],filled:""},{prepend:l(()=>[o(u,{name:"vpn_key"})]),_:1},8,["modelValue","rules"])]),s("div",Ee,[o(U,{label:"Rol",modelValue:t.rolEditar,"onUpdate:modelValue":r[11]||(r[11]=e=>t.rolEditar=e),options:t.rolesDisponibles,rules:[e=>!!e||"El rol es obligatorio"],onInput:i.checkZonaFieldEditar,filled:""},{prepend:l(()=>[o(u,{name:"assignment_ind"})]),_:1},8,["modelValue","options","rules","onInput"])]),t.rolEditar==="Asesor"?(c(),p("div",ve,[o(U,{label:"Zona",modelValue:t.zonaEditar,"onUpdate:modelValue":r[12]||(r[12]=e=>t.zonaEditar=e),options:["Zona 1","Zona 2"],rules:[e=>!!e||"La zona es obligatoria"],filled:""},{prepend:l(()=>[o(u,{name:"place"})]),_:1},8,["modelValue","rules"])])):w("",!0),s("div",Ce,[o(b,{label:"Correo",modelValue:t.emailEditar,"onUpdate:modelValue":r[13]||(r[13]=e=>t.emailEditar=e),rules:[e=>!!e||"El correo es obligatorio"],filled:""},{prepend:l(()=>[o(u,{name:"email"})]),_:1},8,["modelValue","rules"])])]),s("div",ye,[E(o(m,{outline:"",label:"Cancelar",color:"negative",class:"q-mr-sm"},null,512),[[v]]),o(m,{type:"submit",label:"Guardar Cambios",color:"primary",unelevated:"",disable:!i.formValidoEditar},null,8,["disable"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s("div",Ve,[(c(!0),p(z,null,Q(t.rolesDisponibles,e=>(c(),p("div",{key:e,class:"role-section q-mb-xl"},[s("div",{class:S(["role-header",`bg-${i.obtenerColorRol(e)}-1`])},[s("div",Ue,[o(u,{name:i.obtenerIconoRol(e),size:"md",color:i.obtenerColorRol(e),class:"q-mr-sm"},null,8,["name","color"]),s("div",{class:S(["text-h6 text-weight-medium",`text-${i.obtenerColorRol(e)}`])},h(e),3),o(Y,{color:i.obtenerColorRol(e),class:"q-ml-sm"},{default:l(()=>[f(h(i.filtrarUsuariosPorRol(e).length)+" usuarios ",1)]),_:2},1032,["color"])])],2),s("div",we,[(c(!0),p(z,null,Q(i.filtrarUsuariosPorRol(e),n=>(c(),p("div",{key:n.id,class:"col-xs-12 col-sm-6 col-md-4 col-lg-3"},[o(V,{class:S(["user-card",`bg-${i.obtenerColorRol(e)}-1`])},{default:l(()=>[o(_,{class:"text-center"},{default:l(()=>[o(B,{size:"80px",class:"shadow-5",color:n.imagenPerfil?void 0:i.obtenerColorRol(n.rol),"text-color":"white"},{default:l(()=>[n.imagenPerfil?(c(),p("img",{key:0,src:n.imagenPerfil,alt:"Foto de perfil"},null,8,xe)):(c(),p(z,{key:1},[f(h(i.getInitials(n.nombreCompleto)),1)],64))]),_:2},1032,["color"]),s("div",qe,h(n.nombreCompleto),1),s("div",ke," @"+h(n.usuario),1),o(F,{dense:"",color:i.obtenerColorRol(e),"text-color":"white",class:"q-mt-sm",icon:"badge"},{default:l(()=>[f(h(e),1)]),_:2},1032,["color"]),s("div",Ae,h(n.email),1),n.zona?(c(),p("div",ze,[o(F,{dense:"",color:"grey-5","text-color":"white",icon:"place"},{default:l(()=>[f(h(n.zona),1)]),_:2},1024)])):w("",!0)]),_:2},1024),o(I,{color:`${i.obtenerColorRol(e)}-3`},null,8,["color"]),o(D,{align:"center"},{default:l(()=>[o(m,{flat:"",rounded:"",color:"info",icon:"edit",onClick:j=>i.editarUsuario(n)},{default:l(()=>[o(M,null,{default:l(()=>[f("Editar")]),_:1})]),_:2},1032,["onClick"]),o(m,{flat:"",rounded:"",color:"negative",icon:"delete",onClick:j=>i.confirmarEliminar(n.id)},{default:l(()=>[o(M,null,{default:l(()=>[f("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["class"])]))),128)),i.filtrarUsuariosPorRol(e).length===0?(c(),p("div",Se,[o($,{class:"bg-grey-2 text-center"},{avatar:l(()=>[o(u,{name:"info",color:"primary"})]),default:l(()=>[f(" No hay usuarios con el rol de "+h(e),1)]),_:2},1024)])):w("",!0)])]))),128))])]),o(A,{modelValue:t.confirmarEliminarDialog,"onUpdate:modelValue":r[15]||(r[15]=e=>t.confirmarEliminarDialog=e),persistent:""},{default:l(()=>[o(V,{class:"confirm-delete-card"},{default:l(()=>[o(_,{class:"row items-center bg-negative text-white"},{default:l(()=>[o(B,{icon:"warning",color:"white","text-color":"negative"}),Ie]),_:1}),o(_,{class:"q-pt-md"},{default:l(()=>[f(" \xBFEst\xE1s seguro de que deseas eliminar este usuario? Esta acci\xF3n no se puede deshacer. ")]),_:1}),o(D,{align:"right"},{default:l(()=>[E(o(m,{flat:"",label:"Cancelar",color:"primary"},null,512),[[v]]),E(o(m,{unelevated:"",label:"Eliminar",color:"negative",onClick:i.eliminarUsuarioConfirmado},null,8,["onClick"]),[[v]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Fe=O(ee,[["render",Re],["__scopeId","data-v-60126792"]]);export{Fe as default};
